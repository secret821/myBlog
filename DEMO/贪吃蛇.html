<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.60">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>è´ªåƒè›‡ | ç•™ç®€</title><meta name="description" content="ly_blog">
    <link rel="preload" href="/myBlog/assets/style-6a4c5d18.css" as="style"><link rel="stylesheet" href="/myBlog/assets/style-6a4c5d18.css">
    <link rel="modulepreload" href="/myBlog/assets/app-53235c90.js"><link rel="modulepreload" href="/myBlog/assets/framework-204010b2.js"><link rel="modulepreload" href="/myBlog/assets/è´ªåƒè›‡.html-cf8e339f.js"><link rel="modulepreload" href="/myBlog/assets/è´ªåƒè›‡.html-28a8aaf7.js"><link rel="prefetch" href="/myBlog/assets/index.html-2a55f01b.js" as="script"><link rel="prefetch" href="/myBlog/assets/index.html-afc320e7.js" as="script"><link rel="prefetch" href="/myBlog/assets/åŠ¨æ€èƒŒæ™¯å›¾.html-e8d420df.js" as="script"><link rel="prefetch" href="/myBlog/assets/å¡«è‰²æ¸¸æˆ.html-1fadcf3e.js" as="script"><link rel="prefetch" href="/myBlog/assets/æ‹¼å›¾æ¸¸æˆ.html-dc6281b1.js" as="script"><link rel="prefetch" href="/myBlog/assets/æ—¶é’Ÿ.html-bb63273e.js" as="script"><link rel="prefetch" href="/myBlog/assets/index.html-6a2f259b.js" as="script"><link rel="prefetch" href="/myBlog/assets/index.html-b9c170d4.js" as="script"><link rel="prefetch" href="/myBlog/assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="/myBlog/assets/index.html-4577ba8c.js" as="script"><link rel="prefetch" href="/myBlog/assets/index.html-1f455fb0.js" as="script"><link rel="prefetch" href="/myBlog/assets/åŠ¨æ€èƒŒæ™¯å›¾.html-971f3eb0.js" as="script"><link rel="prefetch" href="/myBlog/assets/å¡«è‰²æ¸¸æˆ.html-dfd97ceb.js" as="script"><link rel="prefetch" href="/myBlog/assets/æ‹¼å›¾æ¸¸æˆ.html-bae34c36.js" as="script"><link rel="prefetch" href="/myBlog/assets/æ—¶é’Ÿ.html-bc44d148.js" as="script"><link rel="prefetch" href="/myBlog/assets/index.html-bd854b38.js" as="script"><link rel="prefetch" href="/myBlog/assets/index.html-f3dc5479.js" as="script"><link rel="prefetch" href="/myBlog/assets/404.html-d1e63d77.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/myBlog/" class=""><!----><span class="site-name">ç•™ç®€</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/myBlog/" class="" aria-label="HOME"><!--[--><!--]--> HOME <!--[--><!--]--></a></div><div class="navbar-item"><a href="/myBlog/Note/" class="" aria-label="NOTE"><!--[--><!--]--> NOTE <!--[--><!--]--></a></div><div class="navbar-item"><a href="/myBlog/DEMO/" class="router-link-active" aria-label="DEMO"><!--[--><!--]--> DEMO <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/secret821/liuyan.github.io" rel="noopener noreferrer" target="_blank" aria-label="git"><!--[--><!--]--> git <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://weibo.com/u/7346009584" rel="noopener noreferrer" target="_blank" aria-label="å¾®åš"><!--[--><!--]--> å¾®åš <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/myBlog/" class="" aria-label="HOME"><!--[--><!--]--> HOME <!--[--><!--]--></a></div><div class="navbar-item"><a href="/myBlog/Note/" class="" aria-label="NOTE"><!--[--><!--]--> NOTE <!--[--><!--]--></a></div><div class="navbar-item"><a href="/myBlog/DEMO/" class="router-link-active" aria-label="DEMO"><!--[--><!--]--> DEMO <!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/secret821/liuyan.github.io" rel="noopener noreferrer" target="_blank" aria-label="git"><!--[--><!--]--> git <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://weibo.com/u/7346009584" rel="noopener noreferrer" target="_blank" aria-label="å¾®åš"><!--[--><!--]--> å¾®åš <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/myBlog/DEMO/%E5%8A%A8%E6%80%81%E8%83%8C%E6%99%AF%E5%9B%BE.html" class="sidebar-item sidebar-heading" aria-label="åŠ¨æ€èƒŒæ™¯å›¾"><!--[--><!--]--> åŠ¨æ€èƒŒæ™¯å›¾ <!--[--><!--]--></a><!----></li><li><a href="/myBlog/DEMO/%E6%97%B6%E9%92%9F.html" class="sidebar-item sidebar-heading" aria-label="æ—¶é’Ÿâ°"><!--[--><!--]--> æ—¶é’Ÿâ° <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myBlog/DEMO/%E8%B4%AA%E5%90%83%E8%9B%87.html" class="router-link-active router-link-exact-active router-link-active sidebar-item sidebar-heading active" aria-label="è´ªåƒè›‡"><!--[--><!--]--> è´ªåƒè›‡ <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/myBlog/DEMO/%E8%B4%AA%E5%90%83%E8%9B%87.html#gitåœ°å€" class="router-link-active router-link-exact-active sidebar-item" aria-label="gitåœ°å€"><!--[--><!--]--> gitåœ°å€ <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/myBlog/DEMO/%E8%B4%AA%E5%90%83%E8%9B%87.html#start" class="router-link-active router-link-exact-active sidebar-item" aria-label="start"><!--[--><!--]--> start <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/myBlog/DEMO/%E5%A1%AB%E8%89%B2%E6%B8%B8%E6%88%8F.html" class="sidebar-item sidebar-heading" aria-label="å¡«è‰²æ¸¸æˆ"><!--[--><!--]--> å¡«è‰²æ¸¸æˆ <!--[--><!--]--></a><!----></li><li><a href="/myBlog/DEMO/%E6%8B%BC%E5%9B%BE%E6%B8%B8%E6%88%8F.html" class="sidebar-item sidebar-heading" aria-label="æ‹¼å›¾æ¸¸æˆğŸ§©"><!--[--><!--]--> æ‹¼å›¾æ¸¸æˆğŸ§© <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="è´ªåƒè›‡" tabindex="-1"><a class="header-anchor" href="#è´ªåƒè›‡" aria-hidden="true">#</a> è´ªåƒè›‡</h1><p>å­¦ä¹ canvasåšçš„å°test</p><iframe id="iframe" style="width:375px;height:667px;position:relative;border:5px solid red;" frameborder="0" allowfullscreen="true" src="http://127.0.0.1:5500/test1/background.html">  
 </iframe><h2 id="gitåœ°å€" tabindex="-1"><a class="header-anchor" href="#gitåœ°å€" aria-hidden="true">#</a> gitåœ°å€</h2><p><a href="https://github.com/secret821/Mytest/tree/%E8%B4%AA%E5%90%83%E8%9B%87">ç‚¹å‡»è·³è½¬</a></p><h2 id="start" tabindex="-1"><a class="header-anchor" href="#start" aria-hidden="true">#</a> start</h2><p>æŠ€æœ¯æ ˆï¼šcanvasã€phaserã€TS åŸæ–‡é“¾æ¥ï¼šhttps://juejin.cn/post/6987923058002493448æœ¬ç¯‡å®Œæˆé¡¹ç›®åœ°å€å®Œæ•´ä»£ç å¬åˆ°å®ç°ä¸ªå°æ¸¸æˆå°±å¾ˆæ…Œï¼Ÿduckä¸å¿…ï¼ ï¼Œè¿™è¦å­¦ä¸ä¼šï¼Œä½ æ¥æ‰“æˆ‘!ä»Šå¤©è¿˜æ˜¯åˆçº§æ–‡ç« ï¼Œæ‰‹æŠŠæ‰‹å¸¦å¤§å®¶å®ç°ä¸€ä¸ªè´ªåƒè›‡ã€‚å¤§ä½¬ç»•è¿‡ã€‚ä½ å¯ä»¥getï¼šphaserjsçš„ç®€å•ä½¿ç”¨ä¸€ä¸ªæ¸¸æˆçš„æ¨¡æ¿ä»“åº“ phaser + ts + webpack5ä¸€æ¡å¯çˆ±çš„è›‡è›‡åºŸè¯ä¸å¤šè¯´ï¼Œå¼€å¹²!ä¸€ã€åˆ†æéœ€æ±‚(å°ä¼™å­ï¼Œåˆ«æ…Œï¼)è¿™ä¸ªæ¸¸æˆå¯ä»¥æ‹†æˆä»¥ä¸‹æ¨¡å—:ä¸€æ¡å¯çˆ±çš„è›‡è›‡éšæœºç”Ÿæˆçš„æ°´æœwasdé”®ç›˜æ§åˆ¶ä¸Šä¸‹å·¦å³åƒæ°´æœåŠ¨ä½œäºŒã€åŸºç¡€ç¯å¢ƒæ­å»º(TS+phaser)åŸºç¡€æ¡†æ¶æ¯”è¾ƒå¹²å‡€æ²¡æœ‰ä»€ä¹ˆä¸œè¥¿ã€‚æå‰ç»™å¤§å®¶å‡†å¤‡äº†ä¸€ä¸ªå¹²å‡€çš„æ¨¡æ¿ã€‚phaser + ts + webpack5é¡¹ç›®æ¨¡æ¿æ‰€éœ€ç´ æå°±ä¸¤å¼ æ–¹å—å›¾ç‰‡ï¼Œå¤§å®¶å¯ä»¥å»å®Œæ•´çš„é¡¹ç›®é‡Œé¢å»ä¸‹è½½ã€‚å®Œæ•´ä»£ç ç´ æé…ç½®ä»¥åŠé¢„åŠ è½½å›¾ç‰‡æ¯”è¾ƒåŸºç¡€ï¼Œä¸å†èµ˜è¿°äº†ï¼Œä¹‹å‰æ–‡ç« æœ‰ è®²è¿‡ã€‚ä¼ é€é—¨èµ°è¿›äº’åŠ¨è¥é”€ä¸€ï¼šä½¿ç”¨canvaså¼•æ“phaserå®ç°ä¸€ä¸ªæ¨ç®±å­h5æ¸¸æˆå®æˆ˜ä¸‰ã€æ¸¸æˆåœºæ™¯æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ï¼šè›‡è›‡æ˜¯æœ‰ä¸€èŠ‚ä¸€èŠ‚ç»„æˆçš„ï¼Œæ¯ä¸€èŠ‚éƒ½æ˜¯ä¸ªspriteã€‚æ‰€ä»¥è›‡åº”è¯¥æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚æ°´æœæ¯ä¸ªæ°´æœå°±æ˜¯ä¹Ÿæ˜¯ä¸€ä¸ªèŠ‚ç‚¹ã€‚æ–¹ä¾¿åé¢æ‰©å±•ï¼Œæˆ‘ä¹ˆä¹ŸæŠŠæ°´æœåˆå§‹åŒ–æˆæ•°ç»„æ–¹å‘wasd åˆ†åˆ«ä¸ºä¸Šä¸‹å·¦å³4ä¸ªæ–¹å‘ã€‚æˆ‘ä»¬ç”¨å‘é‡è¿›è¡Œè¡¨ç¤ºã€‚ å½“ç„¶ä½ å¯ä»¥ç”¨x,yä¹Ÿå¯ä»¥çš„ã€‚åé¢ä¼šè®²ã€‚åˆ›å»ºä¸»åœºæ™¯MainScene;æ–°å»º src/scenes/mainScene.tsimport FpsText from &#39;../objects/fpsText&#39;</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">MainScene</span> <span class="token keyword">extends</span> <span class="token class-name">Phaser</span><span class="token punctuation">.</span>Scene <span class="token punctuation">{</span>
  fpsText
  <span class="token doc-comment comment">/** é¼ æ ‡äº‹ä»¶ */</span>
  <span class="token keyword">public</span> cursors<span class="token operator">:</span> Phaser<span class="token punctuation">.</span>Types<span class="token punctuation">.</span>Input<span class="token punctuation">.</span>Keyboard<span class="token punctuation">.</span>CursorKeys
  <span class="token doc-comment comment">/** è›‡è›‡ */</span>
  <span class="token keyword">private</span> snakes<span class="token operator">:</span> Phaser<span class="token punctuation">.</span>GameObjects<span class="token punctuation">.</span>Sprite<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token doc-comment comment">/** æœæœ */</span>
  <span class="token keyword">private</span> fruits<span class="token operator">:</span> Phaser<span class="token punctuation">.</span>GameObjects<span class="token punctuation">.</span>Sprite<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token doc-comment comment">/** æ–¹å‘ */</span>
  <span class="token keyword">private</span> moveVec<span class="token operator">:</span> Phaser<span class="token punctuation">.</span>Math<span class="token punctuation">.</span>Vector2
  <span class="token keyword">private</span> updateDelay<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">{</span> key<span class="token operator">:</span> <span class="token string">&#39;MainScene&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>fpsText <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FpsText</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>moveVec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phaser</span><span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">Vector2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token doc-comment comment">/** åˆå§‹åŒ–æ¸¸æˆ */</span>
  <span class="token function">initGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token doc-comment comment">/** é‡æ–°å¼€å§‹æœ¬å…³ */</span>
  <span class="token function">resetGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token doc-comment comment">/** åˆ¤æ–­æ˜¯å¦ç»“æŸ */</span>
  <span class="token keyword">private</span> <span class="token function">gameOver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
  <span class="token doc-comment comment">/**å¸§ */</span>
  <span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>fpsText<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™ä¸ªæ—¶å€™ä¸å‡ºæ„å¤–ï¼Œå°±å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç©ºç™½çš„åœºæ™¯ï¼Œå·¦ä¸Šè§’æœ‰ä¸ªFPS.å››ã€ç”»ä¸€æ¡å°è›‡è›‡æˆ‘ä¹ˆå…ˆå®šä¹‰ä¸€ä¸‹æ¯ä¸€èŠ‚è›‡è›‡çš„å®½é«˜BOX_SIZEã€‚ä»¥åŠåˆå§‹åŒ–ä¸€æ¡é•¿åº¦ä¸ºSNAKE_START_LENGTH è›‡è›‡ã€‚æ–°å»º src/constants/</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code>config<span class="token punctuation">.</span>tsexport <span class="token keyword">const</span> <span class="token constant">CONFIG</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token doc-comment comment">/** æ ¼å­å¤§å° */</span>
  <span class="token constant">BOX_SIZE</span><span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span>
  <span class="token doc-comment comment">/** åˆå§‹çš„è›‡è›‡é•¿åº¦ */</span>
  <span class="token constant">SNAKE_START_LENGTH</span><span class="token operator">:</span> <span class="token number">4</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬æ–°å¢ä¸¤ä¸ªæ–¹æ³•ã€‚initSnake: åˆå§‹åŒ–è›‡è›‡ã€‚å¾ªç¯SNAKE_START_LENGTHï¼Œç”Ÿæˆåæ ‡ï¼Œç„¶åå»è°ƒç”¨ä¸‹é¢genneratorSnakeItemï¼šæ ¹æ®åæ ‡ç”Ÿæˆè›‡çš„ä¸€èŠ‚item /** åˆå§‹åŒ–è›‡è›‡ */</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code>  <span class="token keyword">private</span> <span class="token function">initSnake</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// åˆå§‹åŒ– è›‡ 4ä¸ªå…ƒç´ , ä»4ï¼Œ 4å¼€å§‹</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">SNAKE_START_LENGTH</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>snakes<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">genneratorSnakeItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token number">4</span> <span class="token operator">+</span> i<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">BOX_SIZE</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">4</span> <span class="token operator">*</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">BOX_SIZE</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token doc-comment comment">/** ç”Ÿæˆè›‡è›‡çš„item */</span>
  <span class="token keyword">private</span> <span class="token function">genneratorSnakeItem</span><span class="token punctuation">(</span>pos<span class="token operator">:</span> <span class="token constant">IPOS</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>add<span class="token punctuation">.</span><span class="token function">sprite</span><span class="token punctuation">(</span>pos<span class="token punctuation">.</span>x<span class="token punctuation">,</span> pos<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token string">&#39;snake&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setDisplaySize</span><span class="token punctuation">(</span><span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">BOX_SIZE</span><span class="token punctuation">,</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">BOX_SIZE</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setOrigin</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>æˆ‘ä»¬åœ¨initGameæ‰§è¡Œ<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initSnake</span><span class="token punctuation">(</span><span class="token punctuation">)</span>æ­¤æ—¶åº”è¯¥å¯ä»¥çœ‹åˆ°ä¸€æ¡é•¿åº¦ä¸º<span class="token number">4</span>çš„å°è›‡ï¼Œä¸‹ä¸€æ­¥å°±è®©å°è›‡åŠ¨èµ·æ¥ï¼šäº”ã€è®©å°è›‡è›‡è·‘èµ·æ¥å°è›‡å°±è¿™ä¹ˆèººç€è‚¯å®šä¸è¡Œï¼Œæ€ä¹ˆè®©å®ƒåŠ¨èµ·æ¥å‘¢ï¼Ÿç›‘å¬wasdæ–¹å‘é”®å°è›‡æ ¹æ®æ–¹å‘ï¼Œè¿›è¡Œç§»åŠ¨å…ˆè¯´æ–¹å‘ä¸ç®¡wasdå“ªä¸ªé”®ï¼Œæˆ‘ä»¬éƒ½ç”¨æ˜¯åæ ‡x<span class="token punctuation">,</span>yæ¥è¡¨ç¤ºæ–¹å‘ã€‚wå‘ä¸Šï¼Œé‚£ä¹ˆ<span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span>aå‘å·¦ï¼Œé‚£ä¹ˆ<span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span>så‘ä¸‹ï¼Œé‚£ä¹ˆ<span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span>då‘ä¸Šï¼Œé‚£ä¹ˆ<span class="token punctuation">{</span>x<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">}</span>åœ¨å¸§äº‹ä»¶é‡Œé¢æˆ‘ä»¬å»æŠŠå°è›‡çš„åæ ‡åŠ ä¸Šå¯¹åº”çš„æ–¹å‘åæ ‡ã€‚å°è›‡å°±å¯ä»¥ç§»åŠ¨äº†ã€‚è›‡ç§»åŠ¨è¿™é‡Œå†é‡æ–°å¼ºè°ƒä¸‹ï¼šæ•°ç»„çš„æœ€åä¸€é¡¹ä¸ºè›‡å¤´ä¸¾ä¸ªæ —å­ï¼šæˆ‘ä»¬æŒ‰äº†dé”®ï¼Œè®©è›‡å‘å³ç§»åŠ¨ã€‚æˆ‘ä»¬åªéœ€è¦ç§»åŠ¨è›‡å°¾å°±å¯ä»¥è¾¾åˆ°æ•ˆæœäº†ã€‚è›‡å°¾çš„æ–°åæ ‡ä¸ºè›‡å¤´çš„åæ ‡ <span class="token operator">+</span> ä¸Šæ–¹å‘å‘é‡æˆ‘äº²æ‰‹ç”»ä¸ªç¾å¦™çš„ç¤ºä¾‹å›¾<span class="token operator">:</span><span class="token function">é‚£å°±ä¸Šä»£ç å§ï¼šé¦–å…ˆcreateç”Ÿå‘½å‘¨æœŸé‡Œé¢æŠŠé”®ç›˜äº‹ä»¶ç›‘å¬ä»¥åŠæ–¹å‘å‘é‡åˆå§‹åŒ–æ‰ã€‚create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>fpsText <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FpsText</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>cursors <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>input<span class="token punctuation">.</span>keyboard<span class="token punctuation">.</span><span class="token function">createCursorKeys</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>input<span class="token punctuation">.</span>keyboard<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;keydown&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onListenerKeyDown</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>moveVec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phaser</span><span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">Vector2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">initGame</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/** ç›‘å¬é”®ç›˜äº‹ä»¶ */</span>
<span class="token keyword">private</span> <span class="token function">onListenerKeyDown</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Object<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token constant">KEY_DIR</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
    <span class="token keyword">let</span> vec <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phaser</span><span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">Vector2</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>e<span class="token operator">?.</span>key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token constant">KEY_DIR</span><span class="token punctuation">.</span><span class="token constant">UP</span><span class="token operator">:</span>
        vec<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
        <span class="token keyword">break</span>
      <span class="token keyword">case</span> <span class="token constant">KEY_DIR</span><span class="token punctuation">.</span><span class="token constant">LEFT</span><span class="token operator">:</span>
        vec<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
        <span class="token keyword">break</span>
      <span class="token keyword">case</span> <span class="token constant">KEY_DIR</span><span class="token punctuation">.</span><span class="token constant">DOWN</span><span class="token operator">:</span>
        vec<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">break</span>
      <span class="token keyword">case</span> <span class="token constant">KEY_DIR</span><span class="token punctuation">.</span><span class="token constant">RIGHT</span><span class="token operator">:</span>
        vec<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">break</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>moveVec <span class="token operator">=</span> vec
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åå…³é”®ä»£ç æ¥äº†ã€‚ä¸ºäº†æ§åˆ¶é€Ÿåº¦ï¼Œæˆ‘ä»¬å¢åŠ ä¸€ä¸ªupdateDelayçš„æ•°å­—ã€‚æ¯ä¸€å¸§+1ã€‚ç„¶ååªæœ‰åœ¨20å¸§æ‰çœŸæ­£æ¸²æŸ“ä¸€æ¬¡ã€‚è¿™ä¸ª20å¯ä»¥åé¢æ‰©å±•æˆä¸ºé€Ÿåº¦ã€‚updateäº‹ä»¶é‡Œé¢æ·»åŠ å¦‚ä¸‹ä»£ç </p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token function">update</span><span class="token punctuation">(</span>dt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>fpsText<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>updateDelay<span class="token operator">++</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>moveVec<span class="token punctuation">.</span>x <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>moveVec<span class="token punctuation">.</span>y <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>updateDelay <span class="token operator">%</span> <span class="token number">20</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>updateDelay <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token comment">// æ•°ç»„æœ€åä¸€é¡¹ä¸º è›‡å¤´</span>
      <span class="token keyword">let</span> snakesFirst <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>snakes<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>snakes<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>
      <span class="token keyword">let</span> snakesLast <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>snakes<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token comment">//è·å–æœ¬æ¬¡é¢„ç§»åŠ¨çš„ç‚¹åæ ‡</span>
      snakesLast<span class="token operator">!</span><span class="token punctuation">.</span>x <span class="token operator">=</span> snakesFirst<span class="token punctuation">.</span>x <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>moveVec<span class="token punctuation">.</span>x <span class="token operator">*</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">BOX_SIZE</span>
      snakesLast<span class="token operator">!</span><span class="token punctuation">.</span>y <span class="token operator">=</span> snakesFirst<span class="token punctuation">.</span>y <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>moveVec<span class="token punctuation">.</span>y <span class="token operator">*</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">BOX_SIZE</span>
      <span class="token comment">//æ·»åŠ åˆ°å¤´éƒ¨</span>
      <span class="token comment">// this.physics.add.overlap(snakesLast, this.fruits, this.collectFruit, null, this)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>snakes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>snakesLast<span class="token operator">!</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ­¤æ—¶æ­¤åˆ»ï¼Œä½ çš„å°è›‡è›‡åº”è¯¥å¯ä»¥ç§»åŠ¨äº†ã€‚è¿™éƒ¨åˆ†ä»£ç æ¯”è¾ƒé•¿ï¼Œå¦‚æœä¸å¥½å†™ï¼Œå¯ä»¥ç›´æ¥å‚è€ƒæºç ï¼šå®Œæ•´ä»£ç å…­ã€åƒæ°´æœç”Ÿæˆæ°´æœæˆ‘ä»¬ç”Ÿæˆæ°´æœçš„æ—¶å€™ï¼Œæ— éå°±æ˜¯éšæœºåæ ‡æ”¾ç½®ä¸€ä¸ªæ°´æœã€‚éšæœºåæ ‡çš„å­¦é—®åœ¨äºï¼šåæ ‡éœ€è¦å’Œè›‡çš„æ ¼å­ä¸€æ ·ã€‚æˆ‘ä»¬éœ€è¦è®¡ç®—å‡ºï¼Œæ•´ä¸ªå±å¹•å¤§æ¦‚x,yåˆ†åˆ«å¯ä»¥æ”¾ç½®å¤šå°‘ä¸ªæ°´æœmaxX,maxYã€‚ç„¶åå†è¿™ä¸ªé‡Œé¢å–éšæœºæ•°ã€‚æ–°ç”Ÿæˆçš„æ°´æœï¼Œä¸èƒ½ç”Ÿæˆåœ¨è›‡èº«ä¸Šã€‚å¦‚æœè½åˆ°è›‡èº«ä¸Šäº†ï¼Œç»§ç»­é€’å½’ä¸€ä¸ªæ–°çš„åæ ‡ã€‚æ–°å¢genneratorFruitä»¥åŠè·å–éšæœºåæ ‡getNewFruitPosã€‚ä¸ºäº†åƒåˆ°ç¬¬ä¸€ä¸ªæ°´æœï¼Œè®°å¾—åœ¨initGameæ–¹æ³•é‡Œé¢è°ƒç”¨ä¸€æ¬¡this.genneratorFruit()ã€‚ /** ç”Ÿæˆæ°´æœçš„ä½ç½®ï¼Œä¸è¦å‡ºç°åœ¨è›‡çš„èº«ä¸Š */</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">private</span> <span class="token function">getNewFruitPos</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token constant">IPOS</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> maxX <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>game<span class="token punctuation">.</span>config<span class="token punctuation">.</span>width <span class="token operator">/</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">BOX_SIZE</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> maxY <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span><span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>game<span class="token punctuation">.</span>config<span class="token punctuation">.</span>height <span class="token operator">/</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">BOX_SIZE</span> <span class="token operator">/</span> <span class="token number">3</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> x <span class="token operator">=</span> Phaser<span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">Between</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> maxX<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">BOX_SIZE</span>
  <span class="token keyword">let</span> y <span class="token operator">=</span> Phaser<span class="token punctuation">.</span>Math<span class="token punctuation">.</span><span class="token function">Between</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> maxY<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">BOX_SIZE</span>
  <span class="token keyword">let</span> isOnSnake <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>snakes<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>x <span class="token operator">===</span> x <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>y <span class="token operator">===</span> y<span class="token punctuation">)</span>
  <span class="token keyword">return</span> isOnSnake <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getNewFruitPos</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token punctuation">{</span> x<span class="token punctuation">,</span> y <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/** éšæœºæœæœ */</span>
<span class="token keyword">private</span> <span class="token function">genneratorFruit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> pos <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getNewFruitPos</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> fruit <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>add
    <span class="token punctuation">.</span><span class="token function">sprite</span><span class="token punctuation">(</span>pos<span class="token punctuation">.</span>x<span class="token punctuation">,</span> pos<span class="token punctuation">.</span>y<span class="token punctuation">,</span> <span class="token string">&#39;fruit&#39;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">setDisplaySize</span><span class="token punctuation">(</span><span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">BOX_SIZE</span><span class="token punctuation">,</span> <span class="token constant">CONFIG</span><span class="token punctuation">.</span><span class="token constant">BOX_SIZE</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setOrigin</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>fruits<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fruit<span class="token punctuation">)</span>
<span class="token punctuation">}</span>åƒæ°´æœå‰é¢æˆ‘ä»¬å·²ç»æŠŠæ°´æœå’Œè›‡çš„æ ¼å­åæ ‡ç»Ÿä¸€äº†ï¼Œè¿™é‡Œçš„åƒæ°´æœå°±å¥½åšäº†ã€‚<span class="token number">1</span>ã€è¦åˆ¤æ–­è›‡å¤´æœ‰æ²¡æœ‰ç¢°åˆ°æ°´æœã€‚<span class="token number">2</span>ã€åœ¨æ°´æœåæ ‡è¿™é‡Œï¼Œæ–°ç”Ÿæˆä¸€ä¸ªè›‡çš„èŠ‚itemã€‚<span class="token number">3</span>ã€é”€æ¯å½“å‰æ°´æœï¼Œé‡æ–°ç”Ÿæˆä¸€ä¸ªupdate æ–¹æ³•é‡Œé¢æ–°å¢æ£€æµ‹æ˜¯å¦ç¢°åˆ°æ°´æœ<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">collectFruit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ã€‚åˆ›å»ºcollectFruitæ–¹æ³•<span class="token doc-comment comment">/** åƒåˆ°æ°´æœ */</span>
<span class="token keyword">private</span> <span class="token function">collectFruit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>fruits<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>_fruit<span class="token punctuation">,</span> index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>_fruit<span class="token punctuation">.</span>x <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>snakes<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>snakes<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>x <span class="token operator">&amp;&amp;</span> _fruit<span class="token punctuation">.</span>y <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>snakes<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>snakes<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// æ ¹æ®å½“å‰æ°´æœåæ ‡ï¼Œæ–°å¢ä¸€ä¸ªè›‡è›‡çš„item</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>snakes<span class="token punctuation">.</span><span class="token function">unshift</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">genneratorSnakeItem</span><span class="token punctuation">(</span><span class="token punctuation">{</span> x<span class="token operator">:</span> _fruit<span class="token punctuation">.</span>x<span class="token punctuation">,</span> y<span class="token operator">:</span> _fruit<span class="token punctuation">.</span>y <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token comment">//é”€æ¯è¿™ä¸ªæ°´æœ</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>fruits<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
      _fruit<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token comment">// ç”Ÿæˆä¸‹ä¸€ä¸ªæ°´æœ</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">genneratorFruit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>æ‰“å¼€æµè§ˆå™¨çœ‹çœ‹ï¼Ÿ ä½ çš„è´ªåƒè›‡å°±æ˜¯ä¸æ˜¯å°±å®Œæˆäº†ï¼ç¢°æ’è‡ªå·±åŠç¢°å¢™æˆ‘ä»¬éœ€è¦åœ¨updateæ–¹æ³•é‡Œé¢æ–°å¢ä¸¤ä¸ªæ£€æµ‹<span class="token punctuation">,</span>å› ä¸ºè›‡å¤´åœ¨æœ€å‰é¢ï¼Œæˆ‘ä»¬åªéœ€è¦åˆ¤æ–­è›‡å¤´è¿™ä¸ªå…ƒç´ åæ ‡å°±<span class="token constant">OK</span>äº†ã€‚ä¸èƒ½ç¢°åˆ°è‡ªå·±<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">checkSelf</span><span class="token punctuation">(</span>snakesFirst<span class="token punctuation">)</span>ä¸èƒ½æ’å¢™<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">checkWall</span><span class="token punctuation">(</span>snakesFirst<span class="token punctuation">)</span><span class="token doc-comment comment">/** æ˜¯å¦ç¢°åˆ°è‡ªå·± */</span>
<span class="token keyword">private</span> <span class="token function">checkSelf</span><span class="token punctuation">(</span>snakesFirst<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> isCheckSelf <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>snakes<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>x <span class="token operator">===</span> snakesFirst<span class="token punctuation">.</span>x <span class="token operator">&amp;&amp;</span> item<span class="token punctuation">.</span>y <span class="token operator">===</span> snakesFirst<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// å–ä¸ªå·§ï¼Œæ‰¾å‡ºåæ ‡å’Œè›‡å¤´ä¸€æ ·çš„å…ƒç´ ï¼Œå› ä¸ºè›‡å¤´è‚¯å®šç­‰äºè›‡å¤´ï¼Œæ‰€ä»¥è¦ åŒ¹é…List&gt;1</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>isCheckSelf<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;ç¢°åˆ°çš„è‡ªå·±å•¦&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

 <span class="token doc-comment comment">/** æ˜¯å¦ç¢°å¢™ */</span>
<span class="token keyword">private</span> <span class="token function">checkWall</span><span class="token punctuation">(</span>snakesFirst<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> isCheckWall <span class="token operator">=</span> snakesFirst<span class="token punctuation">.</span>x <span class="token operator">&gt;=</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>game<span class="token punctuation">.</span>config<span class="token punctuation">.</span>width  <span class="token operator">||</span> snakesFirst<span class="token punctuation">.</span>x <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">||</span> snakesFirst<span class="token punctuation">.</span>y <span class="token operator">&gt;=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>game<span class="token punctuation">.</span>config<span class="token punctuation">.</span>height <span class="token operator">||</span> snakesFirst<span class="token punctuation">.</span>y <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token comment">// å–ä¸ªå·§ï¼Œæ‰¾å‡ºåæ ‡å’Œè›‡å¤´ä¸€æ ·çš„å…ƒç´ ï¼Œå› ä¸ºè›‡å¤´è‚¯å®šç­‰äºè›‡å¤´ï¼Œæ‰€ä»¥è¦ åŒ¹é…List&gt;1</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>isCheckWall<span class="token punctuation">)</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;æ’å¢™å•¦&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç»“è¯­ä¸€ä¸ªç®€å•çš„å°æ¸¸æˆå°±å®Œæˆäº†ã€‚phaserjsé‡Œé¢å°è£…å¥½çš„ç¢°æ’æ£€æµ‹ã€‚å¯ä»¥ç›´æ¥ç”¨ã€‚å› ä¸ºè¿™é‡Œçš„ç¢°æ’å¾ˆç®€å•ï¼Œæˆ‘ä»¬å°±è‡ªå·±å®ç°äº†ã€‚</p><p><a href="https://www.yuque.com/yw8upm/hoz8zc/xczvyl">åŸæ–‡é“¾æ¥</a> â€‹</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 826148658@qq.com">liuyan</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/myBlog/DEMO/%E6%97%B6%E9%92%9F.html" class="" aria-label="æ—¶é’Ÿâ°"><!--[--><!--]--> æ—¶é’Ÿâ° <!--[--><!--]--></a></span><span class="next"><a href="/myBlog/DEMO/%E5%A1%AB%E8%89%B2%E6%B8%B8%E6%88%8F.html" class="" aria-label="å¡«è‰²æ¸¸æˆ"><!--[--><!--]--> å¡«è‰²æ¸¸æˆ <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/myBlog/assets/app-53235c90.js" defer></script>
  </body>
</html>
