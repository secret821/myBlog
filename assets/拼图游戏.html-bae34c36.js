import{_ as e,M as o,p as c,q as l,Q as i,R as n,t as s,N as t,a1 as p}from"./framework-204010b2.js";const u={},r=n("h1",{id:"æ‹¼å›¾æ¸¸æˆğŸ§©",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#æ‹¼å›¾æ¸¸æˆğŸ§©","aria-hidden":"true"},"#"),s(" æ‹¼å›¾æ¸¸æˆğŸ§©")],-1),k=n("p",null,"å­¦ä¹ canvasåšçš„å°test",-1),d=n("p",null,"å­¦ä¹ è¿™ä¸ªæ¸¸æˆçš„æ—¶å€™åšäº†ä¸¤ä¸ªç‰ˆæœ¬ï¼Œç¬”è®°ğŸ“’å¤§éƒ¨åˆ†æ˜¯åœ¨å­¦ä¹ ä¸­çš„å­¦ä¹ ç¬”è®°ï¼Œåœ¨è¿™é‡Œè®°å½•ğŸ“ä¸‹æ¥æ–¹ä¾¿ä»¥åå›æ¸©ç†è§£ åŸºäºwebpack + typescriptå·¥ç¨‹",-1),v=n("iframe",{id:"iframe",style:{width:"375px",height:"667px",position:"relative",border:"5px solid red"},frameborder:"0",allowfullscreen:"true",src:"http://127.0.0.1:5500/test2/clock.html"},`  
 `,-1),m=n("h2",{id:"gitåœ°å€",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#gitåœ°å€","aria-hidden":"true"},"#"),s(" gitåœ°å€")],-1),b=n("p",null,[n("a",{href:"https://github.com/secret821/Mytest/tree/%E6%8B%BC%E5%9B%BE%E6%B8%B8%E6%88%8F"},"ç‚¹å‡»è·³è½¬")],-1),g=n("p",null,[n("a",{href:"https://github.com/secret821/Mytest/tree/%E6%8B%BC%E5%9B%BE%E6%B8%B8%E6%88%8FOOP"},"ï¼ˆoopï¼‰ç‰ˆç‚¹å‡»è·³è½¬")],-1),y=n("h2",{id:"first-version",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#first-version","aria-hidden":"true"},"#"),s(" First version")],-1),f=n("p",null,"æ ¸å¿ƒï¼šæ‹–åŠ¨çš„å®ç° æ‹–åŠ¨æ˜¯æ‹¼å›¾æ¸¸æˆæ ¸å¿ƒåŠŸèƒ½éƒ¨åˆ†ä¹‹ä¸€ã€‚ä¸‹é¢æ˜¯å®ç°æ•ˆæœï¼š",-1),h={href:"https://developer.mozilla.org/zh-CN/docs/Web/API/MouseEvent",target:"_blank",rel:"noopener noreferrer"},w=p(`<p>å¯¹äºç§»åŠ¨æ¸¸æˆï¼Œè§¦æ‘¸äº‹ä»¶æ˜¯æœ€å¸¸ç”¨çš„ç”¨æˆ·äº¤äº’äº‹ä»¶ç±»å‹ã€‚FYGE ä¸ºè§¦æ‘¸äº‹ä»¶è®¾ç½®äº†ä¸“é—¨çš„è§¦æ‘¸äº‹ä»¶ç±»FYGE.MouseEventï¼ˆè¯¦ç»†APIç‚¹å‡»è¿™é‡Œï¼‰</p><p>å…¶åŒ…å«çš„äº‹ä»¶ç±»å‹ä¸»è¦æœ‰ï¼š</p><p>MOUSE_DOWNï¼šå½“ç”¨æˆ·ç¬¬ä¸€æ¬¡è§¦æ‘¸å¯ç”¨è§¦æ‘¸çš„è®¾å¤‡æ—¶ï¼ˆä¾‹å¦‚ï¼Œç”¨æ‰‹æŒ‡è§¦æ‘¸é…æœ‰è§¦æ‘¸å±çš„ç§»åŠ¨ç”µè¯æˆ–å¹³æ¿ç”µè„‘ï¼‰è§¦å‘ MOUSE_OUTï¼šç”±äºæŸä¸ªäº‹ä»¶å–æ¶ˆäº†è§¦æ‘¸æ—¶è§¦å‘ MOUSE_UPï¼šå½“ç”¨æˆ·ç§»é™¤ä¸å¯ç”¨è§¦æ‘¸çš„è®¾å¤‡çš„æ¥è§¦æ—¶ï¼ˆä¾‹å¦‚ï¼Œå°†æ‰‹æŒ‡ä»é…æœ‰è§¦æ‘¸å±çš„ç§»åŠ¨ç”µè¯æˆ–å¹³æ¿ç”µè„‘ä¸ŠæŠ¬èµ·ï¼‰è§¦å‘ MOUSE_MOVEï¼šå½“ç”¨æˆ·è§¦ç¢°è®¾å¤‡å¹¶ç§»åŠ¨æ—¶è¿›è¡Œè§¦å‘ï¼Œè€Œä¸”ä¼šè¿ç»­è§¦å‘ï¼Œç›´åˆ°æ¥è§¦ç‚¹è¢«åˆ é™¤ CLICKï¼šå½“ç”¨æˆ·åœ¨è§¦æ‘¸è®¾å¤‡ä¸Šä¸å¼€å§‹è§¦æ‘¸çš„åŒä¸€æ˜¾ç¤ºå¯¹è±¡å®ä¾‹ä¸ŠæŠ¬èµ·æ¥è§¦ç‚¹æ—¶è§¦å‘ï¼ˆç›¸å½“ä¸ç‚¹å‡»äº‹ä»¶ï¼‰ æ‹–åŠ¨çš„å®ç°å°±æ˜¯:</p><p>æŒç»­è§¦å‘çš„é¼ æ ‡ç§»åŠ¨äº‹ä»¶å›è°ƒä¸­å»æ›´æ–°å›¾ç‰‡çš„ä½ç½®ã€‚ å›¾ç‰‡çš„ä½ç½®åº”è¯¥æ˜¯å›¾ç‰‡åˆå§‹ä½ç½®å†åŠ ä¸Šé¼ æ ‡çš„åç§»é‡ã€‚ åç§»é‡å°±æ˜¯é¼ æ ‡å½“å‰çš„ä½ç½®ä¸é¼ æ ‡åˆå§‹ä½ç½®çš„å·®ã€‚ é¼ æ ‡å½“å‰çš„ä½ç½®å¯ä»¥é€šè¿‡MouseEvent.stageXå’ŒMouseEvent.stageYæ¥è·å–ã€‚ ä»¥ä¸‹æ˜¯æœ€ç»ˆä»£ç </p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">// import FYGE from fyge</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">addDragDemo</span> <span class="token operator">=</span> <span class="token punctuation">(</span>stage<span class="token operator">:</span><span class="token constant">FYGE</span><span class="token punctuation">.</span>Stage<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> pic <span class="token operator">=</span> <span class="token constant">FYGE</span><span class="token punctuation">.</span>Sprite<span class="token punctuation">.</span><span class="token function">fromUrl</span><span class="token punctuation">(</span><span class="token string">&#39;//yun.duiba.com.cn/aurora/assets/b64757cc9839c1dcc80692f6b7db9d97d269c315.png&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    stage<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>pic<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//é¼ æ ‡æŒ‰ä¸‹èµ·å§‹ç‚¹</span>
    <span class="token keyword">let</span> startPoint<span class="token punctuation">;</span>
    <span class="token comment">//å›¾ç‰‡èµ·å§‹ä½ç½®</span>
    <span class="token keyword">let</span> picOriginPos<span class="token punctuation">;</span>
 
    <span class="token keyword">const</span> <span class="token function-variable function">onStageMove</span> <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> <span class="token constant">FYGE</span><span class="token punctuation">.</span>MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//é¼ æ ‡å½“å‰ä½ç½®</span>
        <span class="token keyword">const</span> currentPoint <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> event<span class="token punctuation">.</span>stageX<span class="token punctuation">,</span> y<span class="token operator">:</span> event<span class="token punctuation">.</span>stageY <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment">//é¼ æ ‡æŒ‰ä¸‹ç‚¹åˆ°é¼ æ ‡å½“å‰ç‚¹çš„åç§»é‡</span>
        <span class="token keyword">let</span> mouseOffsetX <span class="token operator">=</span> currentPoint<span class="token punctuation">.</span>x <span class="token operator">-</span> startPoint<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
        <span class="token keyword">let</span> mouseOffsetY <span class="token operator">=</span> currentPoint<span class="token punctuation">.</span>y <span class="token operator">-</span> startPoint<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
 
        pic<span class="token punctuation">.</span>x <span class="token operator">=</span> picOriginPos<span class="token punctuation">.</span>x <span class="token operator">+</span> mouseOffsetX<span class="token punctuation">;</span>
        pic<span class="token punctuation">.</span>y <span class="token operator">=</span> picOriginPos<span class="token punctuation">.</span>y <span class="token operator">+</span> mouseOffsetY<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">const</span> <span class="token function-variable function">onMouseUp_pic</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//é¼ æ ‡æŠ¬èµ·ååº”è¯¥ç§»å‡ºèˆå°ç§»åŠ¨äº‹ä»¶ï¼Œå¦åˆ™ä¼šé‡å¤æ·»åŠ äº‹ä»¶</span>
        stage<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token constant">FYGE</span><span class="token punctuation">.</span>MouseEvent<span class="token punctuation">.</span><span class="token constant">MOUSE_MOVE</span><span class="token punctuation">,</span> onStageMove<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">const</span> <span class="token function-variable function">onMouseDown_pic</span> <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> <span class="token constant">FYGE</span><span class="token punctuation">.</span>MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//å›¾ç‰‡é¼ æ ‡å¼¹èµ·äº‹ä»¶ï¼Œäº‹ä»¶è§¦å‘ä¸€æ¬¡å³ç§»é™¤ï¼Œå¦åˆ™ä¼šé‡å¤æ·»åŠ é¼ æ ‡å¼¹èµ·äº‹ä»¶</span>
        pic<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token constant">FYGE</span><span class="token punctuation">.</span>MouseEvent<span class="token punctuation">.</span><span class="token constant">MOUSE_UP</span><span class="token punctuation">,</span> onMouseUp_pic<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
        <span class="token comment">//æ·»åŠ èˆå°ç§»åŠ¨äº‹ä»¶ï¼Œé¼ æ ‡ç§»åŠ¨å³è§¦å‘</span>
        <span class="token comment">//FYGE.MouseEvent.MOUSE_MOVE ä¼šåœ¨é¼ æ ‡ç§»åŠ¨è¿‡ç¨‹ä¸­è§¦å‘</span>
        stage<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token constant">FYGE</span><span class="token punctuation">.</span>MouseEvent<span class="token punctuation">.</span><span class="token constant">MOUSE_MOVE</span><span class="token punctuation">,</span> onStageMove<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
        <span class="token comment">//eventäº‹ä»¶å¯¹è±¡</span>
        <span class="token comment">//event.stageXï¼Œevent.stageYå½“å‰é¼ æ ‡åœ¨èˆå°çš„ä½ç½®</span>
        startPoint <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> event<span class="token punctuation">.</span>stageX<span class="token punctuation">,</span> y<span class="token operator">:</span> event<span class="token punctuation">.</span>stageY <span class="token punctuation">}</span><span class="token punctuation">;</span>
 
        picOriginPos <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> pic<span class="token punctuation">.</span>x<span class="token punctuation">,</span> y<span class="token operator">:</span> pic<span class="token punctuation">.</span>y <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token comment">//å¢åŠ é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶</span>
    pic<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token constant">FYGE</span><span class="token punctuation">.</span>MouseEvent<span class="token punctuation">.</span><span class="token constant">MOUSE_DOWN</span><span class="token punctuation">,</span> onMouseDown_pic<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5),_={href:"http://gitlab2.dui88.com/fyge/puzzle/tree/drag",target:"_blank",rel:"noopener noreferrer"},E={href:"http://duiba.oss-cn-hangzhou.aliyuncs.com/db_games/fyge/puzzle-drag/index.html",target:"_blank",rel:"noopener noreferrer"},D=p(`<p>å¤šå›¾æ‹–åŠ¨ æ‹–åŠ¨æ˜¯æ‹¼å›¾æ¸¸æˆæ ¸å¿ƒåŠŸèƒ½éƒ¨åˆ†ä¹‹ä¸€ã€‚ä¸‹é¢æ˜¯å®ç°æ•ˆæœï¼š</p><p>å› ä¸ºæ‰€æœ‰å›¾ç‰‡ç¢ç‰‡çš„äº‹ä»¶å¤„ç†æ–¹æ³•éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å®ƒä»¬åº”è¯¥å…¬ç”¨äº‹ä»¶å›è°ƒå‡½æ•°ã€‚é‚£ä¹ˆå¦‚ä½•åŒºåˆ†ä¸åŒçš„ç¢ç‰‡å¯¹è±¡å‘¢ï¼Ÿ</p><p>è¿™å°±éœ€è¦ç”¨åˆ°FYGE.MouseEventäº‹ä»¶å¯¹è±¡çš„targetå’ŒcurrentTargetå±æ€§ï¼ˆAPIè¯¦æƒ…ç‚¹è¿™ï¼‰:</p><p>targetå³äº‹ä»¶ç›®æ ‡ã€‚æ­¤å±æ€§åŒ…å«ç›®æ ‡èŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·å•å‡»â€œç¡®å®šâ€æŒ‰é’®ï¼Œåˆ™ç›®æ ‡èŠ‚ç‚¹å°±æ˜¯åŒ…å«è¯¥æŒ‰é’®çš„æ˜¾ç¤ºåˆ—è¡¨èŠ‚ç‚¹ã€‚ currentTargetï¼Œå³å½“å‰æ­£åœ¨ä½¿ç”¨æŸä¸ªäº‹ä»¶ä¾¦å¬å™¨å¤„ç† Event å¯¹è±¡çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·å•å‡»â€œç¡®å®šâ€æŒ‰é’®ï¼Œåˆ™å½“å‰ç›®æ ‡å¯ä»¥æ˜¯åŒ…å«è¯¥æŒ‰é’®çš„èŠ‚ç‚¹ï¼Œä¹Ÿå¯ä»¥æ˜¯å®ƒçš„å·²ä¸ºè¯¥äº‹ä»¶æ³¨å†Œäº†äº‹ä»¶ä¾¦å¬å™¨çš„å§‹ç¥–ä¹‹ä¸€ã€‚ targetå’ŒcurrentTargeté€‰å…¶ä¸€å³å¯ï¼Œåœ¨é¼ æ ‡äº‹ä»¶ä¸­è§¦å‘äº‹ä»¶çš„ç›®æ ‡éƒ½æ˜¯ç¢ç‰‡æ˜¾ç¤ºå¯¹è±¡ã€‚æ›´å¤šåŒºåˆ«æ•¬è¯·æœŸå¾…åç»­è®²è§£ã€‚</p><p>ä»£ç å…¶å®æ”¹åŠ¨å¹¶ä¸å¤§ï¼š</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">addDragDemo</span> <span class="token operator">=</span> <span class="token punctuation">(</span>stage<span class="token operator">:</span> <span class="token constant">FYGE</span><span class="token punctuation">.</span>Stage<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token constant">PIC_SIZE</span> <span class="token operator">=</span> <span class="token number">200</span><span class="token punctuation">;</span><span class="token comment">//å›¾ç‰‡å°ºå¯¸ï¼Œå•ä½åƒç´ s</span>
    <span class="token keyword">const</span> <span class="token constant">GAP</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span><span class="token comment">//ä½ç½®é—´éš”</span>

    <span class="token keyword">const</span> picture1 <span class="token operator">=</span> <span class="token constant">FYGE</span><span class="token punctuation">.</span>Sprite<span class="token punctuation">.</span><span class="token function">fromUrl</span><span class="token punctuation">(</span><span class="token string">&#39;//yun.duiba.com.cn/aurora/assets/cd16134f2544202ed5676adbd5114286aec44347.png&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    stage<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>picture1<span class="token punctuation">)</span><span class="token punctuation">;</span>
 
    <span class="token keyword">const</span> picture2 <span class="token operator">=</span> <span class="token constant">FYGE</span><span class="token punctuation">.</span>Sprite<span class="token punctuation">.</span><span class="token function">fromUrl</span><span class="token punctuation">(</span><span class="token string">&#39;//yun.duiba.com.cn/aurora/assets/c55dcd277542a6c3e983278ae5835d89848b9bd9.png&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    stage<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>picture2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    picture2<span class="token punctuation">.</span>position<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token constant">PIC_SIZE</span> <span class="token operator">+</span> <span class="token constant">GAP</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
 
    <span class="token comment">//é¼ æ ‡æŒ‰ä¸‹èµ·å§‹ç‚¹</span>
    <span class="token keyword">let</span> startPoint<span class="token punctuation">;</span>
    <span class="token comment">//å›¾ç‰‡èµ·å§‹ä½ç½®</span>
    <span class="token keyword">let</span> currentPictureOrigin<span class="token punctuation">;</span>
 
    <span class="token keyword">const</span> <span class="token function-variable function">onStageMove</span> <span class="token operator">=</span> <span class="token punctuation">(</span>currentPicture<span class="token operator">:</span> <span class="token constant">FYGE</span><span class="token punctuation">.</span>Sprite<span class="token punctuation">,</span> event<span class="token operator">:</span> <span class="token constant">FYGE</span><span class="token punctuation">.</span>MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//é¼ æ ‡å½“å‰ä½ç½®</span>
        <span class="token keyword">const</span> currentPoint <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> event<span class="token punctuation">.</span>stageX<span class="token punctuation">,</span> y<span class="token operator">:</span> event<span class="token punctuation">.</span>stageY <span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment">//é¼ æ ‡æŒ‰ä¸‹ç‚¹åˆ°é¼ æ ‡å½“å‰ç‚¹çš„åç§»é‡</span>
        <span class="token keyword">let</span> mouseOffsetX <span class="token operator">=</span> currentPoint<span class="token punctuation">.</span>x <span class="token operator">-</span> startPoint<span class="token punctuation">.</span>x<span class="token punctuation">;</span>
        <span class="token keyword">let</span> mouseOffsetY <span class="token operator">=</span> currentPoint<span class="token punctuation">.</span>y <span class="token operator">-</span> startPoint<span class="token punctuation">.</span>y<span class="token punctuation">;</span>
 
        currentPicture<span class="token punctuation">.</span>x <span class="token operator">=</span> currentPictureOrigin<span class="token punctuation">.</span>x <span class="token operator">+</span> mouseOffsetX<span class="token punctuation">;</span>
        currentPicture<span class="token punctuation">.</span>y <span class="token operator">=</span> currentPictureOrigin<span class="token punctuation">.</span>y <span class="token operator">+</span> mouseOffsetY<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">const</span> <span class="token function-variable function">onMouseUp_pic</span> <span class="token operator">=</span> <span class="token punctuation">(</span>onStageMoveBinded<span class="token operator">:</span> <span class="token builtin">Function</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">//é¼ æ ‡æŠ¬èµ·ååº”è¯¥ç§»å‡ºèˆå°ç§»åŠ¨äº‹ä»¶ï¼Œå¦åˆ™ä¼šé‡å¤æ·»åŠ äº‹ä»¶</span>
        stage<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token constant">FYGE</span><span class="token punctuation">.</span>MouseEvent<span class="token punctuation">.</span><span class="token constant">MOUSE_MOVE</span><span class="token punctuation">,</span> onStageMoveBinded<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token keyword">const</span> <span class="token function-variable function">onMouseDown_pic</span> <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token operator">:</span> <span class="token constant">FYGE</span><span class="token punctuation">.</span>MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> currentPicture <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
        <span class="token keyword">const</span> onStageMoveBinded <span class="token operator">=</span> <span class="token function">onStageMove</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> currentPicture<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å›¾ç‰‡é¼ æ ‡å¼¹èµ·äº‹ä»¶ï¼Œäº‹ä»¶è§¦å‘ä¸€æ¬¡å³ç§»é™¤ï¼Œå¦åˆ™ä¼šé‡å¤æ·»åŠ é¼ æ ‡å¼¹èµ·äº‹ä»¶</span>
        currentPicture<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token constant">FYGE</span><span class="token punctuation">.</span>MouseEvent<span class="token punctuation">.</span><span class="token constant">MOUSE_UP</span><span class="token punctuation">,</span> <span class="token function">onMouseUp_pic</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> onStageMoveBinded<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
        <span class="token comment">//æ·»åŠ èˆå°ç§»åŠ¨äº‹ä»¶ï¼Œé¼ æ ‡ç§»åŠ¨å³è§¦å‘</span>
        <span class="token comment">//FYGE.MouseEvent.MOUSE_MOVE ä¼šåœ¨é¼ æ ‡ç§»åŠ¨è¿‡ç¨‹ä¸­è§¦å‘</span>
        stage<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token constant">FYGE</span><span class="token punctuation">.</span>MouseEvent<span class="token punctuation">.</span><span class="token constant">MOUSE_MOVE</span><span class="token punctuation">,</span> onStageMoveBinded<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 
        <span class="token comment">//eventäº‹ä»¶å¯¹è±¡</span>
        <span class="token comment">//event.stageXï¼Œevent.stageYå½“å‰é¼ æ ‡åœ¨èˆå°çš„ä½ç½®</span>
        startPoint <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> event<span class="token punctuation">.</span>stageX<span class="token punctuation">,</span> y<span class="token operator">:</span> event<span class="token punctuation">.</span>stageY <span class="token punctuation">}</span><span class="token punctuation">;</span>
 
        currentPictureOrigin <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> currentPicture<span class="token punctuation">.</span>x<span class="token punctuation">,</span> y<span class="token operator">:</span> currentPicture<span class="token punctuation">.</span>y <span class="token punctuation">}</span><span class="token punctuation">;</span>
 
        stage<span class="token punctuation">.</span><span class="token function">addChildAt</span><span class="token punctuation">(</span>currentPicture<span class="token punctuation">,</span> stage<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    <span class="token comment">//å¢åŠ é¼ æ ‡æŒ‰ä¸‹äº‹ä»¶</span>
    picture1<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token constant">FYGE</span><span class="token punctuation">.</span>MouseEvent<span class="token punctuation">.</span><span class="token constant">MOUSE_DOWN</span><span class="token punctuation">,</span> onMouseDown_pic<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    picture2<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token constant">FYGE</span><span class="token punctuation">.</span>MouseEvent<span class="token punctuation">.</span><span class="token constant">MOUSE_DOWN</span><span class="token punctuation">,</span> onMouseDown_pic<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ‰ä¸¤ä¸ªç»†èŠ‚è¦æ³¨æ„ã€‚</p><p>å…¶ä¸€ï¼Œå¾ˆå¤šäººå¸Œæœ›ç”¨å…¨å±€å˜é‡æ¥ä¿å­˜å½“å‰å›¾ç‰‡çš„å¯¹è±¡ï¼Œä½†æ˜¯å…¨å±€å˜é‡å¤šäº†ä¸æ˜¯ä¸€ä»¶å¥½äº‹ã€‚å› ä¸ºå½“å‰æ“ä½œå›¾ç‰‡æ˜¯ä¸€ä¸ªä¸´æ—¶æ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡bindæ–¹æ³•æ¥é¿å…å…¨å±€å˜é‡çš„åˆ›å»ºã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> currentPicture <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">;</span><span class="token comment">//å½“å‰æ“ä½œå›¾ç‰‡æ˜¯ä¸€ä¸ªä¸´æ—¶æ•°æ®</span>
<span class="token keyword">const</span> onStageMoveBinded <span class="token operator">=</span> <span class="token function">onStageMove</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> currentPicture<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//currentPictureå½“å‰å›¾ç‰‡</span>
<span class="token keyword">const</span> <span class="token function-variable function">onStageMove</span> <span class="token operator">=</span> <span class="token punctuation">(</span>currentPicture<span class="token operator">:</span> <span class="token constant">FYGE</span><span class="token punctuation">.</span>Sprite<span class="token punctuation">,</span> event<span class="token operator">:</span> <span class="token constant">FYGE</span><span class="token punctuation">.</span>MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token comment">//å¤„ç†å½“å‰å›¾ç‰‡</span>
<span class="token punctuation">}</span>
<span class="token function">å…¶äºŒï¼Œæˆ‘ä»¬é¢„æœŸå½“å‰æ“ä½œçš„å›¾ç‰‡åº”è¯¥å¤„äºèˆå°æœ€ä¸Šå±‚ã€‚æ‰€ä»¥å½“é¼ æ ‡æŒ‰ä¸‹æ—¶ï¼Œåº”è¯¥å°†å½“å‰æ“ä½œå›¾ç‰‡é€šè¿‡addChildAtæ–¹æ³•</span><span class="token punctuation">(</span><span class="token constant">API</span>åœ¨è¿™<span class="token punctuation">)</span>ç«‹åˆ»ç½®äºå®¹å™¨æœ€ä¸Šå±‚ã€‚

è¿˜æœ‰ä¸€ç§ç®€å†™æ–¹å¼ï¼šaddChildã€‚

stage<span class="token punctuation">.</span><span class="token function">addChildAt</span><span class="token punctuation">(</span>currentPicture<span class="token punctuation">,</span> stage<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//or ç®€å†™ä¸º</span>
stage<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>currentPicture<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¤šå›¾æ‹–åŠ¨æºç ä»“åº“ï¼š<a href="http://gitlab2.dui88.com/fyge/puzzle/tree/multi-drag"></a></p><p>å¤šå›¾æ‹–åŠ¨åœ¨çº¿æ¼”ç¤ºï¼š<a href="http://duiba.oss-cn-hangzhou.aliyuncs.com/db_games/fyge/puzzle-multi-drag/index.html"></a></p><p>ä»£ç è®¾è®¡æ€æƒ³</p><p>ä»£ç åˆ†ç¦»çš„æ¦‚å¿µå¯ä»¥éšå¤„å¯è§ï¼Œvueå°±æ˜¯å¦‚æ­¤ï¼Œåˆ†ç¦»ä½¿å¾—å¯ç»´æŠ¤æ€§å˜å¼ºã€‚</p><p>ä¸€èˆ¬æˆ‘ä»¬å°†æŠ½è±¡æ•°æ®ï¼ˆæ¸¸æˆé€»è¾‘æ•°æ®ï¼‰å’Œè§†å›¾æ•°æ®åˆ†ç¦»å¼€æ¥ï¼Œè¿™æ ·æ–¹ä¾¿æ•°æ®æ£€ç´¢å’Œå¤„ç†ã€‚</p><p>æ•°æ®ç»“æ„è®¾è®¡ å¥½çš„æ•°æ®ç»“æ„è®¾è®¡ä¼šä½¿å¾—æˆ‘ä»¬äº‹å€åŠŸåŠã€‚</p><p>æ•°æ®æŠ½è±¡ æˆ‘ä»¬æ‰“ç®—ç”¨ä¸€ç»´æ•°ç»„æ¥ä¿å­˜æ‹¼å›¾ç¢ç‰‡IDæ•°æ®ã€‚ä¸ºä»€ä¹ˆè¦ç”¨ä¸€ç»´æ•°ç»„ï¼Œè€Œä¸æ˜¯äºŒç»´æ•°ç»„ï¼Ÿä¸€ç»´æ•°ç»„ä¼šä¸å¤ªå¥½ç†è§£ï¼Œä½†æ˜¯å¤„ç†æ•°æ®æ–¹ä¾¿ã€ä»£ç ç®€æ´ã€å¯è¯»æ€§å¼ºã€‚äºŒç»´æ•°ç»„ç†è§£å®¹æ˜“ï¼Œä½†æ•°æ®å¤„ç†æ¯”è¾ƒéº»çƒ¦ã€‚</p><p>æˆ‘ä»¬è®¾ç½®MAX_COLä¸ºæ‹¼å›¾åœ°å›¾çš„å®½åº¦ï¼ŒMAX_ROWä¸ºæ‹¼å›¾åœ°å›¾çš„é«˜åº¦ã€‚é‚£ä¹ˆåˆå§‹çš„å›¾ç‰‡æ•°æ®å°±åº”è¯¥æ˜¯[0,1,2,3 ..... MAX_COL * MAX_ROW]ï¼ŒæŠŠæ•°ç»„çš„æ¯ä¸€é¡¹ä½œä¸ºå›¾ç‰‡çš„IDã€‚</p><p>å‡è®¾MAX_COL * MAX_ROW=3*3ï¼Œé‚£ä¹ˆåˆå§‹æ•°æ®æ˜¯[0,1,2,3,4,5,6,7,8]ã€‚</p><p>åˆ›å»ºé™æ€æ•°æ® æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªfillå‡½æ•°æ¥åˆ›å»ºè¿™ä¸ªåˆå§‹çš„æ¸¸æˆæ•°æ®ï¼Œè¿™ä¸ªæ•°æ®æ˜¯é™æ€çš„ï¼Œä¸ä¼šæ”¹å˜ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> <span class="token function-variable function">fill</span> <span class="token operator">=</span> <span class="token punctuation">(</span>size<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> list<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token punctuation">}</span>
    <span class="token keyword">return</span> list<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token constant">INIT_DATA</span><span class="token operator">:</span> <span class="token builtin">any</span> <span class="token operator">=</span> <span class="token function">fill</span><span class="token punctuation">(</span><span class="token constant">MAX_COL</span> <span class="token operator">*</span> <span class="token constant">MAX_ROW</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//åˆ›å»ºåˆå§‹æ•°æ®</span>
æœ‰äº†åˆå§‹æ•°æ®ä¹‹åï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥åˆ›å»ºç¢ç‰‡æ˜¾ç¤ºå¯¹è±¡åˆ—è¡¨äº†ã€‚è¿™ä¹Ÿæ˜¯ä¸€ä¸ªé™æ€æ•°æ®ï¼Œä¸ä¼šæ”¹å˜ã€‚

<span class="token keyword">const</span> <span class="token constant">PIC_DISPLAY_LIST</span> <span class="token operator">=</span> <span class="token constant">INIT_DATA</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>data <span class="token operator">=&gt;</span> <span class="token constant">FYGE</span><span class="token punctuation">.</span>Sprite<span class="token punctuation">.</span><span class="token function">fromUrl</span><span class="token punctuation">(</span><span class="token constant">PIC_URLS</span><span class="token punctuation">[</span>data<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å›¾ç‰‡è§†å›¾æ•°æ®ï¼ˆåˆ—è¡¨ï¼‰</span>
ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ–¹ä¾¿åœ°é€šè¿‡ç¢ç‰‡æ˜¾ç¤ºå¯¹è±¡æ¥åå‘è·å–ç¢ç‰‡çš„<span class="token constant">ID</span>

<span class="token keyword">const</span> <span class="token function-variable function">getPicDisplayById</span> <span class="token operator">=</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">PIC_DISPLAY_LIST</span><span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//è·å–è§†å›¾æ•°æ®æ–¹æ³•</span>
åˆ›å»ºåŠ¨æ€æ•°æ®
æˆ‘ä»¬åˆ›å»ºgamedataå˜é‡æ¥å­˜å‚¨åŠ¨æ€çš„æ¸¸æˆæ•°æ®ã€‚æ‰“ä¹±ä¹‹åå¯èƒ½æ˜¯è¿™æ ·<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>ã€‚

<span class="token comment">//æˆ‘ä»¬åˆ›å»ºgamedataä½œä¸ºå½“å‰çš„æ¸¸æˆæ•°æ®</span>
<span class="token keyword">let</span> gamedata <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token constant">INIT_DATA</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ·±æ‹·è´</span>
gamedata<span class="token punctuation">.</span><span class="token function">shuffle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å›¾ç‰‡æ‰“ä¹±,shuffleæ–¹æ³•è§ä¸‹æ–‡</span>
ç»´æŠ¤åŠ¨æ€æ•°æ®
é‚£ä¹ˆå½“å›¾ç‰‡äº¤æ¢ä¹‹åï¼Œæ­¤æ•°æ®ä¹Ÿè¦åšå“åº”å˜åŒ–ï¼šåœ¨æ•°ç»„ä¸­äº¤æ¢æ‹–åŠ¨å’Œè½ä¸‹ç¢ç‰‡çš„<span class="token constant">ID</span>ã€‚è¿™æ ·äº¤æ¢å›¾ç‰‡ï¼Œåªéœ€è¦äº¤æ¢æ•°ç»„çš„ä¸¤ä¸ªä½ç½®ã€‚

<span class="token function">swap</span><span class="token punctuation">(</span>currentPicIndex<span class="token punctuation">,</span> dropIndex<span class="token punctuation">,</span> gamedata<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//currentPicIndexæ‹–åŠ¨ç¢ç‰‡IDåœ¨gamedataä¸­çš„ç´¢å¼•ï¼ŒdropIndexè½ä¸‹ç¢ç‰‡çš„IDåœ¨gamedataä¸­çš„ç´¢å¼•ã€‚swapæ–¹æ³•è§ä¸‹æ–‡ã€‚</span>
æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿è·å–currentPicIndexå’ŒdropIndexï¼š

<span class="token keyword">const</span> currentPicId <span class="token operator">=</span> <span class="token function">getPicId</span><span class="token punctuation">(</span>currentPic<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//currentPicæœªæ‹–åŠ¨ç¢ç‰‡çš„æ˜¾ç¤ºå¯¹è±¡</span>
<span class="token keyword">const</span> currentPicIndex <span class="token operator">=</span> gamedata<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>currentPicId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//å‡å¦‚æˆ‘ä»¬çŸ¥é“è½ä¸‹ç¢ç‰‡æ‰€åœ¨çš„è¡Œrowå’Œåˆ—colï¼Œæˆ‘ä»¬å°±èƒ½ç”¨convertRowColToIndexæ–¹æ³•å¿«é€Ÿè·å–dropIndex</span>
<span class="token keyword">const</span> dropIndex <span class="token operator">=</span> <span class="token function">convertRowColToIndex</span><span class="token punctuation">(</span>dropRow<span class="token punctuation">,</span> dropCol<span class="token punctuation">,</span> <span class="token constant">MAX_COL</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//convertRowColToIndexæ–¹æ³•è§ä¸‹æ–‡</span>
æ¸¸æˆèƒœåˆ©
å½“æ•°ç»„æ¢å¤<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">]</span>æ¸¸æˆä¾¿èƒœåˆ©äº†ã€‚æˆ‘ä»¬é€šè¿‡åˆ¤æ–­<span class="token constant">INIT_DATA</span>å’Œgamedataæ˜¯å¦ç›¸åŒæ¥åˆ¤å®šæ¸¸æˆæ˜¯å¦èƒœåˆ©ã€‚

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">equalTo</span><span class="token punctuation">(</span><span class="token constant">INIT_DATA</span><span class="token punctuation">,</span> gamedata<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//æˆ‘ä»¬é€šè¿‡åˆ¤æ–­INIT_DATAå’Œgamedataæ˜¯å¦ç›¸åŒæ¥åˆ¤å®šæ¸¸æˆæ˜¯å¦èƒœåˆ©ã€‚</span>
    <span class="token comment">//å“ˆå“ˆï¼Œèµ¢äº†</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç°åœ¨ï¼Œä½ åº”è¯¥æ„Ÿå—åˆ°äº†ï¼Œè®¾è®¡ç”¨ä¸€ç»´æ•°ç»„æ¥ä¿å­˜æ¸¸æˆæ•°æ®ï¼Œä¼šä½¿å¾—æ•°æ®å¤„ç†éå¸¸æ–¹ä¾¿ï¼Œä»£ç å¯è¯»æ€§ä¹Ÿå¾ˆé«˜ã€‚ï¼ˆä½ å¯ä»¥ç”¨äºŒç»´æ•°ç»„æ”¹å†™ååšå¯¹æ¯”ï¼‰</p><p>ç®—æ³•æ ¸å¿ƒ å°†æ¸¸æˆæ•°æ®æ•°ç»„çš„indexè½¬åŒ–ä¸ºå›¾ç‰‡çš„rowå’Œcol</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> <span class="token function-variable function">convertIndexToRowCol</span> <span class="token operator">=</span> <span class="token punctuation">(</span>index<span class="token punctuation">,</span> maxCol<span class="token punctuation">,</span> maxRow<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> col <span class="token operator">=</span> index <span class="token operator">%</span> maxCol<span class="token punctuation">;</span>
    <span class="token keyword">const</span> row <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>index <span class="token operator">/</span> maxRow<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span><span class="token punctuation">{</span>col<span class="token punctuation">,</span> row<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
å°†ä¸€ç»„rowå’Œcolè½¬åŒ–ä¸ºæ¸¸æˆæ•°æ®æ•°ç»„çš„index
<span class="token keyword">function</span> <span class="token function">convertRowColToIndex</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">,</span> maxCol<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//å¦‚æœæ˜¯ç”¨ä¸€ç»´æ•°ç»„å­˜å‚¨å›¾ç‰‡ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æ¥å°†colå’Œrowè½¬åŒ–æˆindexç´¢å¼•</span>
    <span class="token keyword">let</span> index<span class="token punctuation">;</span>
    index <span class="token operator">=</span> row <span class="token operator">*</span>maxCol <span class="token operator">+</span> col<span class="token punctuation">;</span>
    <span class="token keyword">return</span> index
<span class="token punctuation">}</span>
è·å–æ‰€è½ä¸‹ç¢ç‰‡è¡Œåˆ—
<span class="token comment">//picXï¼ŒpicYä¸ºå›¾ç‰‡åæ ‡</span>
<span class="token keyword">const</span> col <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>picX <span class="token operator">/</span> <span class="token constant">MAX_COL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> row <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>picY <span class="token operator">/</span> <span class="token constant">MAX_ROW</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
æ‰“ä¹±æ•°ç»„
<span class="token builtin">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">shuffle</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> array <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> m <span class="token operator">=</span> array<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
        t<span class="token punctuation">,</span> i<span class="token punctuation">;</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
i <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span> m<span class="token operator">--</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        t <span class="token operator">=</span> array<span class="token punctuation">[</span>m<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span>m<span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        array<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> t<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> array<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//æ³¨æ„æ­¤æ–¹æ³•ä¼šä¿®æ”¹åŸæ•°ç»„ï¼Œä¸‹é¢æ–¹æ³•å¯ä»¥åšæ·±æ‹·è´ã€‚</span>
<span class="token comment">//æˆ‘ä»¬åˆ›å»ºgamedataä½œä¸ºå½“å‰çš„æ¸¸æˆæ•°æ®</span>
<span class="token keyword">let</span> gamedata <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token constant">INIT_DATA</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ·±æ‹·è´</span>
gamedata<span class="token punctuation">.</span><span class="token function">shuffle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å›¾ç‰‡æ‰“ä¹±</span>
åˆ¤æ–­æ•°ç»„ç›¸ç­‰
æˆ‘ä»¬é€šè¿‡åˆ¤æ–­<span class="token constant">INIT_DATA</span>å’Œgamedataæ˜¯å¦ç›¸åŒæ¥åˆ¤å®šæ¸¸æˆæ˜¯å¦èƒœåˆ©ã€‚

<span class="token keyword">const</span> <span class="token function-variable function">equalTo</span> <span class="token operator">=</span> <span class="token punctuation">(</span>array1<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> array2<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>array1<span class="token punctuation">.</span>length <span class="token operator">!=</span> array1<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> len <span class="token operator">=</span> array1<span class="token punctuation">.</span>length <span class="token operator">||</span> array1<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> a <span class="token operator">=</span> array1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> b <span class="token operator">=</span> array2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">!=</span> b<span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token comment">//åˆ¤æ–­æ•°ç»„æ˜¯å¦ç›¸ç­‰</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">equalTo</span><span class="token punctuation">(</span><span class="token constant">INIT_DATA</span><span class="token punctuation">,</span> gamedata<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> 
    <span class="token comment">//æˆ‘ä»¬é€šè¿‡åˆ¤æ–­INIT_DATAå’Œgamedataæ˜¯å¦ç›¸åŒæ¥åˆ¤å®šæ¸¸æˆæ˜¯å¦èƒœåˆ©ã€‚</span>
    <span class="token function">showToast</span><span class="token punctuation">(</span><span class="token string">&#39;å“ˆå“ˆï¼Œèµ¢äº†&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
æ•°ç»„æ•°æ®äº¤æ¢
<span class="token comment">//æ•°ç»„å…ƒç´ äº¤æ¢</span>
<span class="token keyword">const</span> <span class="token function-variable function">swap</span> <span class="token operator">=</span> <span class="token punctuation">(</span>index1<span class="token punctuation">,</span> index2<span class="token punctuation">,</span> list<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> ele1 <span class="token operator">=</span> list<span class="token punctuation">[</span>index1<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> ele2 <span class="token operator">=</span> list<span class="token punctuation">[</span>index2<span class="token punctuation">]</span><span class="token punctuation">;</span>
    list<span class="token punctuation">[</span>index1<span class="token punctuation">]</span> <span class="token operator">=</span> ele2<span class="token punctuation">;</span>
    list<span class="token punctuation">[</span>index2<span class="token punctuation">]</span> <span class="token operator">=</span> ele1<span class="token punctuation">;</span>
    <span class="token keyword">return</span> list<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,23),M={href:"http://gitlab2.dui88.com/fyge/puzzle/tree/puzzle",target:"_blank",rel:"noopener noreferrer"},O={href:"http://duiba.oss-cn-hangzhou.aliyuncs.com/db_games/fyge/puzzle/index.html",target:"_blank",rel:"noopener noreferrer"},x=n("p",null,"è¿›ä¸€æ­¥æå‡ä»£ç å¯ç»´æŠ¤æ€§ æ•´ä½“ä»£ç çœ‹ä¸‹ã€‚å¯è¯»æ€§è¿˜æ˜¯æœ‰å¾…ä¼˜åŒ–ï¼Œä¸ºä»€ä¹ˆï¼Œå› ä¸ºä»–æ˜¯è¿‡ç¨‹å¼ç¼–ç¨‹ã€‚å¯ä»¥è€ƒè™‘é¢å‘å¯¹è±¡oop:",-1),I=n("p",null,"é¢å‘å¯¹è±¡æ–¹æ³•ï¼ŒæŠŠç›¸å…³çš„æ•°æ®å’Œæ–¹æ³•ç»„ç»‡ä¸ºä¸€ä¸ªæ•´ä½“æ¥çœ‹å¾…ï¼Œä»æ›´é«˜çš„å±‚æ¬¡æ¥è¿›è¡Œç³»ç»Ÿå»ºæ¨¡ï¼Œæ›´è´´è¿‘äº‹ç‰©çš„è‡ªç„¶è¿è¡Œæ¨¡å¼ã€‚",-1),P=n("p",null,"åˆå­¦è€…å¯ä»¥äº†è§£ä¸‹OOPåŸºç¡€æ¦‚å¿µå’Œè¯­æ³•:",-1),F={href:"https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/Objects/Object-oriented_JS",target:"_blank",rel:"noopener noreferrer"},S={href:"https://es6.ruanyifeng.com/#docs/class",target:"_blank",rel:"noopener noreferrer"},Y={href:"https://es6.ruanyifeng.com/#docs/class-extends",target:"_blank",rel:"noopener noreferrer"},G=n("h2",{id:"oop",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#oop","aria-hidden":"true"},"#"),s(" OOP")],-1),z=n("p",null,"æœ¬æ–‡åŸºäºwebpack + typescriptå·¥ç¨‹ï¼Œç†è§£è´Ÿæ‹…æ›´è½»ï¼Œå¯ç§»æ¤æ€§æ›´å¼ºï¼šä½¿ç”¨ webpack æ„å»ºTypeScriptåº”ç”¨",-1),T=n("p",null,"å°†ç”¨ä¸¤ç¯‡æ–‡ç« æ¥è®²è¿°å¦‚ä½•å¼€å‘ä¸€ä¸ªé«˜å¯ç»´æŠ¤æ€§çš„æ‹¼å›¾æ¸¸æˆï¼š",-1),A=n("p",null,"1ã€æ‹¼å›¾è§£æ 2ã€OOPçš„æ‹¼å›¾æ¸¸æˆ å¼€åœº é¦–å…ˆï¼Œæˆ‘ä»¬ä¼šå°†æ‹¼å›¾æ¸¸æˆç”¨é¢å‘å¯¹è±¡çš„è®¾è®¡åŸåˆ™åšæ–°çš„è®¾è®¡ï¼Œç„¶åå†OOPçš„æ–¹å¼æ”¹å†™ã€‚è¿™ä¸€æ­¥çš„ç›®çš„æ˜¯ä¸ºäº†å®ç°æ›´å¥½çš„å¯ç»´æŠ¤æ€§ã€‚",-1),C=n("p",null,"ç„¶åï¼Œä¸ºäº†éªŒè¯æˆ‘ä»¬çš„è®¾è®¡çš„ä¼˜è¶Šæ€§ï¼Œä¼šå¯¹éœ€æ±‚åšä¸€ä¸ªå˜æ›´ï¼ŒæŸ¥çœ‹ä»£ç ç»´æŠ¤çš„æˆæœ¬ã€‚",-1),N=n("p",null,"å¼€å§‹æ•™ç¨‹å‰ï¼Œå…ˆæŠŠå˜æ›´åçš„æ¸¸æˆè´´ä¸€ä¸‹ã€‚",-1),q=n("p",null,"å¦å¤–ï¼Œå»ºè®®å…ˆå°†ç›¸åº”çš„ä»£ç æ‹‰å–ä¸‹æ¥ä½œä¸ºé˜…è¯»å‚è€ƒã€‚",-1),U={href:"http://gitlab2.dui88.com/fyge/puzzle/tree/oop",target:"_blank",rel:"noopener noreferrer"},B={href:"http://gitlab2.dui88.com/fyge/puzzle/tree/oop2",target:"_blank",rel:"noopener noreferrer"},L=n("p",null,"å¦‚æœä½ æ˜¯OOPçš„åˆå­¦è€… å…ˆçœ‹çœ‹åŸºç¡€æ¦‚å¿µå’Œè¯­æ³•",-1),R={href:"https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/Objects/Object-oriented_JS",target:"_blank",rel:"noopener noreferrer"},X={href:"https://es6.ruanyifeng.com/#docs/class",target:"_blank",rel:"noopener noreferrer"},J={href:"https://es6.ruanyifeng.com/#docs/class-extends",target:"_blank",rel:"noopener noreferrer"},V=p(`<p><a href="https://www.typescriptlang.org/">æ–‡æ¡£</a> è®¾è®¡åŸåˆ™ OOè®¾è®¡ç¬¬ä¸€å¤§åŸåˆ™å°±æ˜¯å•ä¸€èŒè´£åŸåˆ™ã€‚å®ƒçš„å®šä¹‰æ˜¯ï¼š</p><p>ä¸€ä¸ªå¯¹è±¡åº”è¯¥åªåŒ…å«å•ä¸€çš„èŒè´£,å¹¶ä¸”è¯¥èŒè´£è¢«å®Œæ•´åœ°å°è£…åœ¨ä¸€ä¸ªç±»ä¸­ã€‚ å•ä¸€èŒè´£åŸåˆ™æ˜¯å®ç°é«˜å†…èšã€ä½è€¦åˆçš„æŒ‡å¯¼æ–¹é’ˆã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†ä¼šæŠŠæ¸¸æˆåŠŸèƒ½æ‹†è§£ï¼Œå¹¶æŒ‰ç…§è¿™ä¸ªåŸåˆ™è¿›è¡Œç±»çš„è®¾è®¡ã€‚</p><p>æ‹–æ”¾ï¼ˆDrag å’Œ Dropï¼‰ æ‹–æ”¾ï¼ˆDrag å’Œ Dropï¼‰æ˜¯æ‹¼å›¾æ¸¸æˆçš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒåŒæ—¶å®ƒä¹Ÿæ˜¯å¾ˆå¸¸è§çš„ç‰¹æ€§ï¼ŒDOMä¸­ä¹Ÿæœ‰æ ‡å‡†åŒ–çš„æ‹–æ”¾ç‰¹æ€§ï¼Œè¿™æ¬¡æˆ‘ä»¬è‡ªå·±åœ¨FYGEå®ç°ä¸€ä¸ªæ‹–æ”¾åŠŸèƒ½ã€‚</p><p>æˆ‘ä»¬å°†æ‹–æ”¾æŠ½è±¡æˆä¸ºå‡ ä¸ªç±»:</p><p>DragDropable å®ç°äº†å¯æ‹–æ”¾çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬å›¾ç‰‡ç§»åŠ¨ã€ä½œä¸ºDropå¯¹è±¡æ—¶æ¥æ”¶æ‹–åŠ¨å¯¹è±¡çš„è¡Œä¸ºã€‚å›¾ç‰‡ç¢ç‰‡éœ€è¦ç»§æ‰¿è¿™ä¸ªç±»æ¥è·å–æ‹–æ”¾åŠŸèƒ½ã€‚ DragDropManager ç”¨äºç®¡ç†æ‰€æœ‰çš„æ‹–æ”¾å¯¹è±¡ï¼Œç»™å›¾ç‰‡ç¢ç‰‡å¢åŠ æ‹–æ”¾è¡Œä¸ºã€‚å³ä½¿ç»§æ‰¿äº†DragDropableï¼Œä¸æ·»åŠ åˆ°DragDropManagerä¹Ÿæ— æ³•è¿›è¡Œæ‹–æ”¾æ“ä½œã€‚å¦å¤–ä»–è¿˜æä¾›äº‹ä»¶ç›¸å…³çš„äº‹ä»¶ï¼Œæ‹–æ”¾æ£€æµ‹çš„å®ç°ä»£ç ä¹Ÿåœ¨è¿™é‡Œã€‚ DragDropableç±» è¿™é‡Œè¦ç‰¹åˆ«è¯´æ˜ï¼Œä¸€èˆ¬æˆ‘ä»¬ç§æœ‰å±æ€§å‰åŠ ä¸€ä¸ªä¸‹åˆ’çº¿ç¬¦å·ï¼Œè¿™æ ·èƒ½å¤Ÿæ›´å¿«é€ŸåŒºåˆ†å…¬æœ‰æˆ–è€…ç§æœ‰å±æ€§ï¼Œæå‡ä»£ç å¯è¯»æ€§ã€‚</p><p>å›¾ç‰‡æ‹–åŠ¨å¼€å§‹çš„èµ·å§‹ä½ç½® public originPosÂ : FYGE.Point å¼€å§‹æ‹–åŠ¨çš„æ—¶å€™ä¼šæ›´æ–°è¿™ä¸ªä½ç½®ã€‚å¾ˆæœ‰ç”¨çš„å±æ€§ã€‚</p><p>é¼ æ ‡æŒ‰ä¸‹çš„èµ·å§‹ç‚¹privateÂ _startPoint: FYGE.Point æ–¹ä¾¿ç§»åŠ¨è¿‡ç¨‹ä¸­æ›´æ–°æ‹–åŠ¨å¯¹è±¡çš„ä½ç½®ã€‚</p><p>ä½ç½®è®¡ç®—å…¬å¼ï¼š</p><p>é¼ æ ‡åç§» =Â é¼ æ ‡å½“å‰ä½ç½® - é¼ æ ‡æŒ‰ä¸‹çš„ä½ç½® å¯¹è±¡å½“å‰ä½ç½® = å¯¹è±¡åŸå§‹ä½ç½®originPos +Â é¼ æ ‡åç§»ã€‚ è·å–æ”¾ä¸‹çš„ç‚¹ protected getDropPoint() è¿™ä¸ªç‚¹ç”¨äºæ£€æŸ¥è®¡ç®—æ‰è½å¯¹è±¡ã€‚åœ¨æ‹¼å›¾æ¸¸æˆé‡Œï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šæŠŠå›¾ç‰‡ç¢ç‰‡çš„ä¸­å¿ƒç‚¹æˆ–è€…é¼ æ ‡å½“å‰ä½ç½®ä½œä¸ºæ‰è½çš„ç‚¹ï¼Œè¿™æ ·ä½“éªŒæ¯”è¾ƒå¥½ã€‚</p><p>ä¸åŒçš„æ‹–æ”¾åŠŸèƒ½è¦æ±‚ä¸ä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ±‚æ‹–åŠ¨å¯¹è±¡çš„å­ç±»å¿…é¡»è¦é‡å†™è¿™ä¸ªæ–¹æ³•ã€‚</p><p>è§¦å‘è½ä¸‹äº‹ä»¶å¤„ç†å‡½æ•° public onDrop(drop: DragDropable) å­ç±»å¿…é¡»é‡å†™æ­¤æ–¹æ³•ã€‚</p><p>æ‹–åŠ¨ç»“æŸå¤„ç†å‡½æ•° public onDragEnd(drop: DragDropable) å­ç±»å¿…é¡»é‡å†™æ­¤æ–¹æ³•ã€‚</p><p>DragDropManagerç±» ç»™æ‹–æ”¾å¯¹è±¡æ·»åŠ è¡Œä¸º public add(item: DragDropable) åœ¨æ‹¼å›¾æ¸¸æˆä¸­ï¼Œå›¾ç‰‡ç¢ç‰‡å¯¹è±¡å³ä½¿ç»§æ‰¿äº†DragDropableï¼Œä¸æ·»åŠ åˆ°DragDropManagerä¹Ÿæ— æ³•è¿›è¡Œæ‹–æ”¾æ“ä½œã€‚</p><p>private onDisplayItemDrop(e: FYGE.Event) ç§æœ‰æ–¹æ³•ï¼Œç”¨äºå¤„ç†æ‹–æ”¾æ£€æµ‹ã€‚å…³é”®ä»£ç å¦‚ä¸‹ï¼š</p><p>const drop: DragDropable = dragParent.hitTestPoint(new FYGE.Point(e.data.x / 2, e.data.y / 2), true); Fragmentç±» è¿™æ˜¯å›¾ç‰‡ç¢ç‰‡ç±»ï¼Œç»§æ‰¿DragDropableã€‚è¿™æ ·ä½ å¯ä»¥æ›´åŠ æ–¹ä¾¿çš„è·å–dropIdå’ŒdragIdï¼Œä»¥ä¾¿äº¤æ¢æ•°æ®ã€‚å¯¹æ¯”ä¸‹ä»£ç çœ‹çœ‹ã€‚</p><p>ç¢ç‰‡ID private _ID: number å‚¨å›¾ç‰‡ç¢ç‰‡çš„IDã€‚</p><p>è·å–æ”¾ä¸‹æ£€æµ‹ç‚¹ protected getDropPoint(event: FYGE.MouseEvent) è¿™é‡Œè®¾ç½®çš„æ˜¯å›¾ç‰‡çš„ä¸­å¿ƒç‚¹ä½ç½®ï¼Œä½ è®¾ç½®æˆé¼ æ ‡æŒ‰ä¸‹çš„ä½ç½®ä½“éªŒä¹Ÿokã€‚</p><p>å¤„ç†æ”¾å…¥äº‹ä»¶ onDrop = (drag: DragDropable): void å½“ç¢ç‰‡ä½œä¸ºdropå¯¹è±¡æ—¶ï¼Œå¦‚æœæœ‰æ‹–åŠ¨å¯¹è±¡æ‹–å…¥ï¼Œé‚£ä¹ˆéœ€è¦äº¤æ¢ä½ç½®ã€‚</p><p>æ‹–åŠ¨ç»“æŸ public onDragEnd(drop: DragDropable) å½“ç¢ç‰‡ä½œä¸ºæ‹–åŠ¨å¯¹è±¡æ—¶ï¼Œæ‹–åŠ¨ç»“æŸçš„æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰æ‹–å…¥å…¶ä»–å¯¹è±¡ï¼Œé‚£ä¹ˆè¦å›åŸä½ç½®ã€‚</p><p>Gameç±» åˆå§‹åŒ–æ‹–æ”¾ private _initDragDrop() ä¸»è¦æ³¨å†Œæ¸¸æˆæ‹–æ”¾äº‹ä»¶</p><p>å¤„ç†å¼€å§‹æ‹–æ”¾äº‹ä»¶ private onDragStart(e: FYGE.Event) äº‹ä»¶è§¦å‘æ—¶ï¼Œæˆ‘ä»¬è¦æŠŠå½“å‰æ‹–åŠ¨å›¾ç‰‡ç½®äºæœ€ä¸Šå±‚ã€‚</p><p>å¤„ç†æ‹–æ”¾ç»“æŸäº‹ä»¶ private onDragEnd(e: FYGE.Event) æ‹–æ”¾ç»“æŸåè¦è¿›è¡Œå›¾ç‰‡è§†å›¾ä»¥åŠæ•°æ®çš„äº¤æ¢ã€‚</p><p>OOè®¾è®¡æ€»ç»“ ç»†å¿ƒäººä¼šå‘ç°ï¼ŒDragDropableã€DragDropEventã€DragDropManagerè¿™å‡ ä¸ªç±»å¹¶ä¸ä¾èµ–æ¸¸æˆç›¸å…³çš„ç±»ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ–¹ä¾¿åœ°å°†æ‹–æ”¾åŠŸèƒ½å°è£…æˆä»£ç åº“ï¼Œä»¥ä¾¿å…¶ä»–é¡¹ç›®ä½¿ç”¨ã€‚</p><p>åŒæ—¶ï¼Œé«˜å†…èšä½è€¦åˆè¿™ä¸ªOOè®¾è®¡ç†å¿µçš„ä½“ç°ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬åœ¨ä¿®æ”¹æ¨¡å—Açš„æ—¶å€™ä¸ä¼šå½±å“åˆ°æ¨¡å—Bçš„åŠŸèƒ½ã€‚</p><p>é‡æ„å®Œæ¯• è¿™æ˜¯å®Œæ•´çš„ä»£ç Â <a href="http://gitlab2.dui88.com/fyge/puzzle/tree/oop">ç‚¹è¿™é‡Œè·³è½¬</a></p><p>éœ€æ±‚å˜æ›´ ä¸ºäº†éªŒè¯è®¾è®¡æ€æƒ³ï¼Œæˆ‘ä»¬å¯¹æ¸¸æˆéœ€æ±‚åšä¸‹å˜æ›´ï¼š</p><p>æˆ‘ä»¬å°†æ¸¸æˆåˆ†ä¸ºä¸¤ä¸ªåŒºåŸŸï¼š</p><p>ä¸€æ˜¯å¦‚å‰é¢æè¿°çš„æ‹¼å›¾åŒºï¼Œæ‹¼å›¾æ“ä½œåœ¨æ­¤è¿›è¡Œã€‚ä½†æ˜¯æ­¤åŒºåŸŸåˆå§‹çŠ¶æ€æ˜¯ç©ºç™½çš„ã€‚ äºŒæ˜¯å›¾ç‰‡ç¼©ç•¥å›¾åˆ—è¡¨åŒºï¼Œè¿™é‡Œå­˜æ”¾æ‰€æœ‰å›¾ç‰‡ç¢ç‰‡çš„å°å›¾ã€‚å°å›¾å¿…é¡»æ‹–åˆ°æ‹¼å›¾åŒºæ‰èƒ½è¿›è¡Œæ‹¼å›¾ã€‚ è€ƒè™‘åˆ°ç°åœ¨å°å›¾å’Œå¤§å›¾çš„åŠŸèƒ½ç›¸ä¼¼ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠ½è±¡å‡ºä»–ä»¬çš„çˆ¶ç±» BaseFragmentã€‚å› ä¸ºBaseFragmentå’ŒåŸFragmentåŠŸèƒ½ç›¸åŒï¼ˆä½ç½®äº¤æ¢ã€å”¯ä¸€æ ‡è¯†ã€è½ç©ºå½’ä½ï¼‰ï¼Œå…¶å®åªéœ€è¦åŸæ¥Fragmentç±»ç›´æ¥æ”¹åå³å¯ã€‚</p><p>å¤§å›¾ç±»ä¸å˜ï¼Œè¿˜æ˜¯Fragmentã€‚å¢åŠ ä¸€ä¸ªå°å›¾ç±»Thumbnailã€‚ä¸‹é¢å…·ä½“æè¿°ä¸‹å„ä¸ªç±»çš„åŠŸèƒ½ã€‚</p><p>æ‹–æ”¾ç®¡ç†ç±»DragDropManagerçš„å˜åŒ– å½“å…ƒç´ ç§»é™¤èˆå°çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åˆ é™¤ç›¸å…³çš„äº‹ä»¶ï¼Œä»¥ä¾¿æ›´å¥½åœ°å†…å­˜å›æ”¶ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">//åˆå§‹åŒ–æ‹–æ”¾å¯¹è±¡äº‹ä»¶</span>
<span class="token keyword">public</span> <span class="token function">add</span><span class="token punctuation">(</span>item<span class="token operator">:</span> DragDropable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    item<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;DROP&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onDisplayItemDrop<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
    item<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token constant">FYGE</span><span class="token punctuation">.</span>MouseEvent<span class="token punctuation">.</span><span class="token constant">MOUSE_DOWN</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onMouseDown<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
    item<span class="token punctuation">.</span><span class="token function">once</span><span class="token punctuation">(</span><span class="token constant">FYGE</span><span class="token punctuation">.</span>Event<span class="token punctuation">.</span><span class="token constant">REMOVED_FROM_STAGE</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>remove<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function-variable function">remove</span> <span class="token operator">=</span> <span class="token punctuation">(</span>event<span class="token operator">:</span><span class="token constant">FYGE</span><span class="token punctuation">.</span>Event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> item <span class="token operator">=</span> event<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
    item<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">&#39;DROP&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onDisplayItemDrop<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
    item<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token constant">FYGE</span><span class="token punctuation">.</span>MouseEvent<span class="token punctuation">.</span><span class="token constant">MOUSE_DOWN</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>onMouseDown<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å°å›¾ç±»Thumbnail è€ƒè™‘åˆ°å°å›¾ä¸æ¥å—ä»»ä½•æ‰è½äº‹ä»¶ï¼Œæ‰€ä»¥éœ€è¦é‡å†™Thumbnailç±»çš„onDropæ–¹æ³•ï¼Œå¹¶æ¸…ç©ºæ–¹æ³•å†…å®¹ã€‚åªéœ€è¦ç®€å•ä¸€è¡Œä»£ç å³å¯ï¼Œè€Œä¸”ä¸éœ€è¦æ›´æ”¹å…¶ä»–æ¨¡å—åŠŸèƒ½ï¼ˆæˆ‘ä»¬åªæ”¹äº†å­ç±»åŠŸèƒ½ï¼Œå¹¶ä¸å½±å“çˆ¶ç±»ï¼Œä¹Ÿä¸å½±å“å¤§å›¾ç±»Fragmentï¼‰ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code>    onDrop <span class="token operator">=</span> <span class="token punctuation">(</span>drag<span class="token operator">:</span> DragDropable<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¦å¤–ï¼Œè€ƒè™‘åˆ°ï¼Œåœ¨å°å›¾æ‹–æ”¾ç»“æŸåï¼Œå³ä½¿è½å…¥äº†å…¶ä»–å°å›¾ï¼Œä¹Ÿä¸å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦æ”¹åŠ¨ä¸€ä¸‹onDragEndæ–¹æ³•ï¼šåªæœ‰è½å…¥å¯¹è±¡æ˜¯ç©ºæˆ–è€…æ˜¯å°å›¾æ‰ä¼šå½’ä½ã€‚</p><p>è¿™é‡Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°instanceofè¿ç®—ç¬¦æ¥åˆ¤æ–­æ‹–å…¥å˜é‡çš„æ˜¯å¤§å›¾è¿˜æ˜¯å°å›¾ã€‚</p><p>å¦å¤–ï¼Œåœ¨æ‹–å…¥å¤§å›¾çš„æ—¶å€™ï¼Œéœ€è¦ç§»é™¤æ‰å°å›¾å¯¹è±¡ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">//</span>
<span class="token keyword">public</span> <span class="token function">onDragEnd</span><span class="token punctuation">(</span>drop<span class="token operator">:</span> DragDropable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>drop <span class="token operator">||</span> drop <span class="token keyword">instanceof</span> <span class="token class-name">Thumbnail</span><span class="token punctuation">)</span>
            <span class="token constant">FYGE</span><span class="token punctuation">.</span>Tween<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">to</span><span class="token punctuation">(</span><span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>originPos<span class="token punctuation">.</span>x<span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>originPos<span class="token punctuation">.</span>y <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>drop <span class="token keyword">instanceof</span> <span class="token class-name">Fragment</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;å¤§å›¾æ¥äº†ï¼Œç„¶åï¼Œå°±æ²¡ç„¶åäº†&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è‡³æ­¤ï¼Œä½ æ˜¯å¦å‘ç°äº†ï¼Œå¥½çš„è®¾è®¡ä¼šè®©ä½ çš„ä»£ç å¤ç”¨ç‡é«˜ï¼Œä¿®æ”¹ä»£ç é‡å˜å°‘ï¼ŒåŠŸèƒ½å½±å“å˜å°ã€‚</p><p>å¤§å›¾ç±»Fragment åˆå§‹çš„å¤§å›¾æ˜¯ç©ºç™½çŠ¶æ€ï¼Œæˆ‘ä»¬éœ€è¦ç»™ä»–æ·»åŠ ä¸€ä¸ªç™½è‰²èƒŒæ™¯ã€‚å¹¶ä¸”è¿˜è¦ç»™ä»–ä¸€ä¸ªåˆå§‹çš„ç©ºç™½çŠ¶æ€çš„IDã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">private</span> _initialID<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span> 
<span class="token keyword">get</span> <span class="token function">initialID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span><span class="token builtin">number</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_initialID  <span class="token punctuation">}</span> 
<span class="token keyword">set</span> <span class="token function">initialID</span><span class="token punctuation">(</span>val<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_initialID <span class="token operator">=</span> val<span class="token punctuation">;</span> <span class="token punctuation">}</span>
<span class="token keyword">private</span> <span class="token function">_createBg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> bg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">FYGE</span></span><span class="token punctuation">.</span><span class="token function">Graphics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bg<span class="token punctuation">.</span><span class="token function">beginFill</span><span class="token punctuation">(</span><span class="token number">0xffffff</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bg<span class="token punctuation">.</span><span class="token function">drawRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">FRAGMENT_SIZE</span><span class="token punctuation">,</span> <span class="token constant">FRAGMENT_SIZE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        bg<span class="token punctuation">.</span><span class="token function">endFill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_bg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span>bg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è€ƒè™‘åˆ°ç¼©ç•¥å›¾æ‹–å…¥å¤§å›¾åéœ€è¦é‡æ–°è®¾ç½®å¤§å›¾ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¿®æ”¹å¤§å›¾çš„onDropæ–¹æ³•ã€‚</p><p>è¿™é‡Œè¦è€ƒè™‘ä¸¤ç§æ‹–æ”¾æƒ…å†µï¼š</p><p>å¤§å›¾æ‹–å…¥å¤§å›¾ å°å›¾æ‹–å…¥å¤§å›¾ ç”±äºå¤§å›¾åˆå§‹çŠ¶æ€æ˜¯ç©ºç™½èƒŒæ™¯ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªç©ºç™½èƒŒæ™¯æ¥ä»£ç†onDropæ–¹æ³•ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token comment">//hi</span>
<span class="token keyword">class</span> <span class="token class-name">Background</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token constant">FYGE</span></span><span class="token punctuation">.</span>Graphics <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">beginFill</span><span class="token punctuation">(</span><span class="token number">0xffffff</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">drawRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token constant">FRAGMENT_SIZE</span><span class="token punctuation">,</span> <span class="token constant">FRAGMENT_SIZE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">endFill</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    onDrop <span class="token operator">=</span> <span class="token punctuation">(</span>drag<span class="token operator">:</span> DragDropable<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">removeBg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">onDrop</span><span class="token punctuation">(</span>drag<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¤„ç†æ‰è½onDrop = (drag: DragDropable) ä¸¤ä»¶äº‹ï¼š</p><p>è®¾ç½®ID åŒæ­¥çº¹ç† å¾ˆç®€å•ã€‚</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code>onDrop <span class="token operator">=</span> <span class="token punctuation">(</span>drag<span class="token operator">:</span> DragDropable<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> thumb <span class="token operator">=</span> drag <span class="token keyword">as</span> Thumbnail<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>texture <span class="token operator">=</span> drag<span class="token punctuation">.</span>texture<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>_ID <span class="token operator">=</span> thumb<span class="token punctuation">.</span><span class="token constant">ID</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ–°çš„Gameç±» ä¿®æ”¹private _createGamedata() åˆå§‹æ•°æ®åº”è¯¥æ˜¯ä¸ªç©ºæ•°ç»„ã€‚</p><p>åˆ›å»ºå¤§å›¾åˆ—è¡¨Â private _createFragmentList() ç‰¹åˆ«è¯´æ˜ï¼Œç©ºç™½çš„å¤§å›¾ä¸åŒ…å«IDï¼Œæ‰€ä»¥æ²¡æœ‰ä½œIDè®¾ç½®ã€‚ä½†æ˜¯ä»–æœ‰ä¸€ä¸ªåˆå§‹çš„initialIDã€‚</p><p>å¤„ç†æ‹–åŠ¨ç»“æŸé€»è¾‘ private onDragEnd(e: FYGE.Event) ç¨å¾®åšä¸€ä¸‹å¤„ç†å³å¯</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">private</span> <span class="token function">onDragEnd</span><span class="token punctuation">(</span>e<span class="token operator">:</span> <span class="token constant">FYGE</span><span class="token punctuation">.</span>Event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> drag<span class="token operator">:</span> BaseFragment <span class="token operator">=</span> e<span class="token punctuation">.</span>data<span class="token punctuation">.</span>drag<span class="token punctuation">;</span>
        <span class="token keyword">const</span> drop<span class="token operator">:</span> BaseFragment <span class="token operator">=</span> e<span class="token punctuation">.</span>data<span class="token punctuation">.</span>drop<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>drop <span class="token keyword">instanceof</span> <span class="token class-name">Thumbnail</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;å¤§å›¾æ‹–å°å›¾ï¼Œå°å›¾æ‹–å°å›¾ï¼Œæ— è§†&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//å¤§å›¾æ‹–å¤§å›¾</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>drag <span class="token keyword">instanceof</span> <span class="token class-name">Fragment</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;å¤§å›¾æ‹–å¤§å›¾&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>drag <span class="token keyword">instanceof</span> <span class="token class-name">Thumbnail</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//å°å›¾æ‹–å¤§å›¾</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>drop <span class="token operator">||</span> drop<span class="token punctuation">.</span><span class="token constant">ID</span> <span class="token operator">!==</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//è¿™ä¸ªä½ç½®å·²ç»æœ‰å›¾äº†</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>_gamedata<span class="token punctuation">[</span><span class="token punctuation">(</span>drop <span class="token keyword">as</span> Fragment<span class="token punctuation">)</span><span class="token punctuation">.</span>initialID<span class="token punctuation">]</span> <span class="token operator">=</span> drag<span class="token punctuation">.</span><span class="token constant">ID</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;å›¾ç‰‡æ•°æ®&#39;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_gamedata<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>i <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>drop <span class="token operator">&amp;&amp;</span> drop <span class="token keyword">instanceof</span> <span class="token class-name">Fragment</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">swapElement</span><span class="token punctuation">(</span>drag<span class="token punctuation">.</span><span class="token constant">ID</span><span class="token punctuation">,</span> drop<span class="token punctuation">.</span><span class="token constant">ID</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_gamedata<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">isSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&#39;èµ¢äº†&#39;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,52),W={href:"http://gitlab2.dui88.com/fyge/puzzle/tree/oop2",target:"_blank",rel:"noopener noreferrer"},j=p(`<p>æ€»ç»“ æœ€åï¼Œä½ ä¼šå‘ç°ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰åšå¤§çš„å˜æ›´ï¼Œä¾¿å®ç°äº†ä¸€ä¸ªå¤æ‚çš„éœ€æ±‚çš„å˜æ›´ã€‚</p><p>äº‹å®è¯æ˜ï¼Œæˆ‘ä»¬çš„è®¾è®¡æ˜¯æœ‰ç€é«˜å¯ç»´æŠ¤æ€§çš„ã€‚</p><div class="language-html line-numbers-mode" data-ext="html"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>canvas</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>canvas<span class="token punctuation">&quot;</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>600<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>600<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>canvas</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./clock.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3);function Z(K,Q){const a=o("ExternalLinkIcon");return c(),l("div",null,[r,k,d,v,m,i(" ``` html "),b,g,y,f,n("p",null,[s("å®ç°éœ€è¦ç”¨åˆ°é¼ æ ‡ï¼ˆè§¦æ‘¸ï¼‰äº‹ä»¶API FYGE.MouseEventï¼ŒFYGEé¼ æ ‡äº‹ä»¶APIçš„è®¾è®¡æ˜¯å‚è€ƒDOMï¼ˆ"),n("a",h,[s("https://developer.mozilla.org/zh-CN/docs/Web/API/MouseEvent"),t(a)]),s("ï¼‰ï¼ŒäºŒè€…ç”¨æ³•ç›¸ä¼¼ã€‚")]),w,n("p",null,[s("æ‹–åŠ¨æºç ä»“åº“ï¼š"),n("a",_,[s("http://gitlab2.dui88.com/fyge/puzzle/tree/drag"),t(a)])]),n("p",null,[s("æ‹–åŠ¨åœ¨çº¿æ¼”ç¤ºï¼š"),n("a",E,[s("http://duiba.oss-cn-hangzhou.aliyuncs.com/db_games/fyge/puzzle-drag/index.html"),t(a)])]),D,n("p",null,[s("æœ€ç»ˆä»£ç  æ¸¸æˆæºç ä»“åº“ï¼š"),n("a",M,[s("http://gitlab2.dui88.com/fyge/puzzle/tree/puzzle"),t(a)])]),n("p",null,[s("æ¸¸æˆåœ¨çº¿æ¼”ç¤ºï¼š"),n("a",O,[s("http://duiba.oss-cn-hangzhou.aliyuncs.com/db_games/fyge/puzzle/index.html"),t(a)])]),x,I,P,n("p",null,[s("é€‚åˆåˆå­¦è€…çš„JavaScripté¢å‘å¯¹è±¡ "),n("a",F,[s("https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/Objects/Object-oriented_JS"),t(a)]),s(" Class çš„åŸºæœ¬è¯­æ³• "),n("a",S,[s("https://es6.ruanyifeng.com/#docs/class"),t(a)])]),n("p",null,[s("Class çš„ç»§æ‰¿ "),n("a",Y,[s("https://es6.ruanyifeng.com/#docs/class-extends"),t(a)])]),G,z,T,A,C,N,q,n("p",null,[s("è¿™æ˜¯éœ€æ±‚å˜æ›´å‰çš„ä»£ç ï¼š"),n("a",U,[s("http://gitlab2.dui88.com/fyge/puzzle/tree/oop"),t(a)]),s("ã€‚")]),n("p",null,[s("è¿™æ˜¯éœ€æ±‚å˜æ›´åçš„ä»£ç ï¼š"),n("a",B,[s("http://gitlab2.dui88.com/fyge/puzzle/tree/oop2"),t(a)]),s("Â ã€‚")]),L,n("p",null,[s("é€‚åˆåˆå­¦è€…çš„JavaScripté¢å‘å¯¹è±¡ "),n("a",R,[s("https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/Objects/Object-oriented_JS"),t(a)]),s(" Class çš„åŸºæœ¬è¯­æ³• "),n("a",X,[s("https://es6.ruanyifeng.com/#docs/class"),t(a)]),s(" Class çš„ç»§æ‰¿ "),n("a",J,[s("https://es6.ruanyifeng.com/#docs/class-extends"),t(a)]),s(" å¦å¤–OOPç‰¹æ€§å¾ˆå¤šæ˜¯å»ºç«‹åœ¨TypeScriptè¯­è¨€ä¹‹ä¸Šçš„ï¼Œæ‰€ä»¥ä½ éœ€è¦æœ‰è¿™ç§è¯­è¨€åŸºç¡€ã€‚æ–‡æ¡£å‚è€ƒï¼š")]),V,n("p",null,[s("å®Œæ•´ä»£ç  "),n("a",W,[s("http://gitlab2.dui88.com/fyge/puzzle/tree/oop2"),t(a)])]),j])}const $=e(u,[["render",Z],["__file","æ‹¼å›¾æ¸¸æˆ.html.vue"]]);export{$ as default};
